<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Introduction to GLM | Data Skills for Reproducible Research</title>
<meta name="description" content="8.1 Learning Objectives  Basic Define the components of the GLM Simulate data using GLM equations (video) Identify the model parameters that correspond to the data-generation parameters Understand...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Chapter 8 Introduction to GLM | Data Skills for Reproducible Research">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/reprores-v2/glm.html">
<meta property="og:image" content="https://psyteachr.github.io/reprores-v2/images/logos/logo.png">
<meta property="og:description" content="8.1 Learning Objectives  Basic Define the components of the GLM Simulate data using GLM equations (video) Identify the model parameters that correspond to the data-generation parameters Understand...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Introduction to GLM | Data Skills for Reproducible Research">
<meta name="twitter:description" content="8.1 Learning Objectives  Basic Define the components of the GLM Simulate data using GLM equations (video) Identify the model parameters that correspond to the data-generation parameters Understand...">
<meta name="twitter:image" content="https://psyteachr.github.io/reprores-v2/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9.4/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/style.css">
<link rel="stylesheet" href="include/webex.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="v2">Data Skills for Reproducible Research</a>:
        <small class="text-muted">v2</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Getting Started</a></li>
<li><a class="" href="repro.html"><span class="header-section-number">2</span> Reproducible Workflows</a></li>
<li><a class="" href="ggplot.html"><span class="header-section-number">3</span> Data Visualisation</a></li>
<li><a class="" href="data.html"><span class="header-section-number">4</span> Working with Data</a></li>
<li><a class="" href="joins.html"><span class="header-section-number">5</span> Data Relations</a></li>
<li><a class="" href="tidyr.html"><span class="header-section-number">6</span> Tidy Data</a></li>
<li><a class="" href="dplyr.html"><span class="header-section-number">7</span> Data Wrangling</a></li>
<li><a class="active" href="glm.html"><span class="header-section-number">8</span> Introduction to GLM</a></li>
<li><a class="" href="func.html"><span class="header-section-number">9</span> Iteration &amp; Functions</a></li>
<li><a class="" href="sim.html"><span class="header-section-number">10</span> Probability &amp; Simulation</a></li>
<li><a class="" href="acknowledgements.html">Acknowledgements</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="installingr.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="conventions.html"><span class="header-section-number">B</span> Conventions</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">C</span> Symbols</a></li>
<li><a class="" href="datasets.html"><span class="header-section-number">D</span> Datasets</a></li>
<li><a class="" href="exercise-answers.html"><span class="header-section-number">E</span> Exercise Answers</a></li>
<li><a class="" href="bookrefs.html"><span class="header-section-number">F</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/reprores-v2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="glm" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Introduction to GLM<a class="anchor" aria-label="anchor" href="#glm"><i class="fas fa-link"></i></a>
</h1>
<div class="right meme">
<img src="images/memes/glm_meme.png" alt="Top panel: Fred from Scooby Doo, about to unmask a bound villain, with the text 't-test, ANOVA, Correlation, Regression, etc.'; Bottom panel: Villain unmasked, with the text: 'The general linear model'; credit: Stuart Ritchie">
</div>
<!--
<div class="right meme"><img src="images/memes/linear_regression.jpg"
     alt="Woody and Buzz from Toy Story. Top text: Linear Regression; Bottom text: Linear regression everywhere" /></div>
     -->
<div id="ilo-glm" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Learning Objectives<a class="anchor" aria-label="anchor" href="#ilo-glm"><i class="fas fa-link"></i></a>
</h2>
<div id="basic-4" class="section level3 unnumbered">
<h3>Basic<a class="anchor" aria-label="anchor" href="#basic-4"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Define the <a href="glm.html#glm-components">components</a> of the GLM</li>
<li>
<a href="glm.html#sim-glm">Simulate data</a> using GLM equations <a href="https://youtu.be/JQ90LnVCbKc" class="video">(video)</a>
</li>
<li>Identify the model parameters that correspond to the data-generation parameters</li>
<li>Understand and plot <a href="glm.html#residuals">residuals</a> <a href="https://youtu.be/sr-NtxiH2Qk" class="video">(video)</a>
</li>
<li>
<a href="glm.html#predict">Predict new values</a> using the model <a href="https://youtu.be/0o4LEbVVWfM" class="video">(video)</a>
</li>
<li>Explain the differences among <a href="glm.html#coding-schemes">coding schemes</a> <a href="https://youtu.be/SqL28AbLj3g" class="video">(video)</a>
</li>
</ol>
</div>
<div id="intermediate-4" class="section level3 unnumbered">
<h3>Intermediate<a class="anchor" aria-label="anchor" href="#intermediate-4"><i class="fas fa-link"></i></a>
</h3>
<ol start="7" style="list-style-type: decimal">
<li>Demonstrate the <a href="glm.html#test-rels">relationships</a> among two-sample t-test, one-way ANOVA, and linear regression</li>
<li>Given data and a GLM, <a href="glm.html#decomp">generate a decomposition matrix</a> and calculate sums of squares, mean squares, and F ratios for a one-way ANOVA</li>
</ol>
</div>
</div>
<div id="setup-glm" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Setup<a class="anchor" aria-label="anchor" href="#setup-glm"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># libraries needed for these examples</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">30250</span><span class="op">)</span> <span class="co"># makes sure random numbers are reproducible</span></code></pre></div>
</div>
<div id="glm-1" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> GLM<a class="anchor" aria-label="anchor" href="#glm-1"><i class="fas fa-link"></i></a>
</h2>
<div id="what-is-the-glm" class="section level3" number="8.3.1">
<h3>
<span class="header-section-number">8.3.1</span> What is the GLM?<a class="anchor" aria-label="anchor" href="#what-is-the-glm"><i class="fas fa-link"></i></a>
</h3>
<p>The <a class="glossary" target="_blank" title="A mathematical model comparing how one or more independent variables affect a continuous dependent variable" href="https://psyteachr.github.io/glossary/g#general-linear-model">General Linear Model</a> (GLM) is a general mathematical framework for expressing relationships among variables that can express or test linear relationships between a numerical <a class="glossary" target="_blank" title="The target variable that is being analyzed, whose value is assumed to depend on other variables." href="https://psyteachr.github.io/glossary/d#dependent-variable">dependent variable</a> and any combination of <a class="glossary" target="_blank" title="Data that can only take certain values, such as types of pet." href="https://psyteachr.github.io/glossary/c#categorical">categorical</a> or <a class="glossary" target="_blank" title="Data that can take on any values between other existing values." href="https://psyteachr.github.io/glossary/c#continuous">continuous</a> <a class="glossary" target="_blank" title="A variable whose value is assumed to influence the value of a dependent variable." href="https://psyteachr.github.io/glossary/i#independent-variable">independent variables</a>.</p>
</div>
<div id="glm-components" class="section level3" number="8.3.2">
<h3>
<span class="header-section-number">8.3.2</span> Components<a class="anchor" aria-label="anchor" href="#glm-components"><i class="fas fa-link"></i></a>
</h3>
<p>There are some mathematical conventions that you need to learn to understand the equations representing linear models. Once you understand those, learning about the GLM will get much easier.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Component of GLM</th>
<th>Notation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Dependent Variable (DV)</td>
<td><span class="math inline">\(Y\)</span></td>
</tr>
<tr class="even">
<td>Grand Average</td>
<td>
<span class="math inline">\(\mu\)</span> (the Greek letter "mu")</td>
</tr>
<tr class="odd">
<td>Main Effects</td>
<td><span class="math inline">\(A, B, C, \ldots\)</span></td>
</tr>
<tr class="even">
<td>Interactions</td>
<td><span class="math inline">\(AB, AC, BC, ABC, \ldots\)</span></td>
</tr>
<tr class="odd">
<td>Random Error</td>
<td><span class="math inline">\(S(Group)\)</span></td>
</tr>
</tbody>
</table></div>
<div class="right meme">
<img src="images/memes/confused-math-lady.png" alt="Confused math lady meme">
</div>
<p>The linear equation predicts the dependent variable (<span class="math inline">\(Y\)</span>) as the sum of the grand average value of <span class="math inline">\(Y\)</span> (<span class="math inline">\(\mu\)</span>, also called the intercept), the main effects of all the predictor variables (<span class="math inline">\(A+B+C+ \ldots\)</span>), the interactions among all the predictor variables (<span class="math inline">\(AB, AC, BC, ABC, \ldots\)</span>), and some random error (<span class="math inline">\(S(Group)\)</span>). The equation for a model with two predictor variables (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) and their interaction (<span class="math inline">\(AB\)</span>) is written like this:</p>
<p><span class="math inline">\(Y\)</span> ~ <span class="math inline">\(\mu+A+B+AB+S(Group)\)</span></p>
<p>Don't worry if this doesn't make sense until we walk through a concrete example.</p>
</div>
<div id="sim-glm" class="section level3" number="8.3.3">
<h3>
<span class="header-section-number">8.3.3</span> Simulating data from GLM<a class="anchor" aria-label="anchor" href="#sim-glm"><i class="fas fa-link"></i></a>
</h3>
<p>A good way to learn about linear models is to <a class="glossary" target="_blank" title="Generating data from summary parameters" href="https://psyteachr.github.io/glossary/s#simulation">simulate</a> data where you know exactly how the variables are related, and then analyse this simulated data to see where the parameters show up in the analysis.</p>
<p>We'll start with a very simple linear model that just has a single categorical factor with two levels. Let's say we're predicting reaction times for congruent and incongruent trials in a Stroop task for a single participant. Average reaction time (<code>mu</code>) is 800ms, and is 50ms faster for congruent than incongruent trials (<code>effect</code>).</p>
<div class="warning">
<p>A <strong>factor</strong> is a categorical variable that is used to divide subjects into groups, usually to draw some comparison. Factors are composed of different <strong>levels</strong>. Do not confuse factors with levels!</p>
<p>In the example above, trial type is a <select class="webex-solveme" data-answer='["factor"]'><option></option>
<option>factor</option>
<option>level</option></select>, incongrunt is a <select class="webex-solveme" data-answer='["level"]'><option></option>
<option>factor</option>
<option>level</option></select>, and congruent is a <select class="webex-solveme" data-answer='["level"]'><option></option>
<option>factor</option>
<option>level</option></select>.</p>
</div>
<p>You need to represent <a class="glossary" target="_blank" title="Data that can only take certain values, such as types of pet." href="https://psyteachr.github.io/glossary/c#categorical">categorical</a> factors with numbers. The numbers, or <a class="glossary" target="_blank" title="How to represent categorical variables with numbers for use in models" href="https://psyteachr.github.io/glossary/c#coding-scheme">coding scheme</a> you choose will affect the numbers you get out of the analysis and how you need to interpret them. Here, we will <a class="glossary" target="_blank" title="A coding scheme for categorical variables that contrasts each group mean with the mean of all the group means." href="https://psyteachr.github.io/glossary/e#effect-code">effect code</a> the trial types so that congruent trials are coded as +0.5, and incongruent trials are coded as -0.5.</p>
<p>A person won't always respond exactly the same way. They might be a little faster on some trials than others, due to random fluctuations in attention, learning about the task, or fatigue. So we can add an <a class="glossary" target="_blank" title="The term in a model that represents the difference between the actual and predicted values" href="https://psyteachr.github.io/glossary/e#error-term">error term</a> to each trial. We can't know how much any specific trial will differ, but we can characterise the distribution of how much trials differ from average and then sample from this distribution.</p>
<p>Here, we'll assume the error term is sampled from a <a class="glossary" target="_blank" title="A symmetric distribution of data where values near the centre are most probable." href="https://psyteachr.github.io/glossary/n#normal-distribution">normal distribution</a> with a <a class="glossary" target="_blank" title="A descriptive statistic that measures how spread out data are relative to the mean." href="https://psyteachr.github.io/glossary/s#standard-deviation">standard deviation</a> of 100 ms (the mean of the error term distribution is always 0). We'll also sample 100 trials of each type, so we can see a range of variation.</p>
<p>So first create variables for all of the parameters that describe your data.</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n_per_grp</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">800</span> <span class="co"># average RT</span>
<span class="va">effect</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># average difference between congruent and incongruent trials</span>
<span class="va">error_sd</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># standard deviation of the error term</span>
<span class="va">trial_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"congruent"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"incongruent"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="co"># effect code</span></code></pre></div>
<p>Then simulate the data by creating a data table with a row for each trial and columns for the trial type and the error term (random numbers samples from a normal distribution with the SD specified by <code>error_sd</code>). For categorical variables, include both a column with the text labels (<code>trial_type</code>) and another column with the coded version (<code>trial_type.e</code>) to make it easier to check what the codings mean and to use for graphing. Calculate the dependent variable (<code>RT</code>) as the sum of the grand mean (<code>mu</code>), the coefficient (<code>effect</code>) multiplied by the effect-coded predictor variable (<code>trial_type.e</code>), and the error term.</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  trial_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">trial_types</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_per_grp</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    trial_type.e <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">trial_type</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">trial_types</span><span class="op">)</span>,
    error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">error_sd</span><span class="op">)</span>,
    RT <span class="op">=</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">effect</span><span class="op">*</span><span class="va">trial_type.e</span> <span class="op">+</span> <span class="va">error</span>
  <span class="op">)</span></code></pre></div>
<div class="info">
<p>The <code>!!!</code> (triple bang) in the code <code>recode(trial_type, !!!trial_types)</code> is a way to expand the vector <code>trial_types &lt;- c("congruent" = 0.5, "incongruent" = -0.5)</code>. It's equivalent to <code>recode(trial_type, "congruent" = 0.5, "incongruent" = -0.5)</code>. This pattern avoids making mistakes with recoding because there is only one place where you set up the category to code mapping (in the <code>trial_types</code> vector).</p>
</div>
<p>Last but not least, always plot simulated data to make sure it looks like you expect.</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">trial_type</span>, <span class="va">RT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">trial_type</span><span class="op">)</span>, 
               width <span class="op">=</span> <span class="fl">0.25</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-sim"></span>
<img src="08-glm_files/figure-html/plot-sim-1.png" alt="Simulated Data" width="100%"><p class="caption">
Figure 8.1: Simulated Data
</p>
</div>
</div>
<div id="linear-regression" class="section level3" number="8.3.4">
<h3>
<span class="header-section-number">8.3.4</span> Linear Regression<a class="anchor" aria-label="anchor" href="#linear-regression"><i class="fas fa-link"></i></a>
</h3>
<p>Now we can analyse the data we simulated using the function <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. It takes the formula as the first argument. This is the same as the data-generating equation, but you can omit the error term (this is implied), and takes the data table as the second argument. Use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function to see the statistical summary.</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">~</span> <span class="va">trial_type.e</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">my_lm</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RT ~ trial_type.e, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -302.110  -70.052    0.948   68.262  246.220 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   788.192      7.206 109.376  &lt; 2e-16 ***
## trial_type.e   61.938     14.413   4.297 2.71e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 101.9 on 198 degrees of freedom
## Multiple R-squared:  0.08532,    Adjusted R-squared:  0.0807 
## F-statistic: 18.47 on 1 and 198 DF,  p-value: 2.707e-05</code></pre>
<p>Notice how the <strong>estimate</strong> for the <code>(Intercept)</code> is close to the value we set for <code>mu</code> and the estimate for <code>trial_type.e</code> is close to the value we set for <code>effect</code>.</p>
<div class="try">
<p>Change the values of <code>mu</code> and <code>effect</code>, resimulate the data, and re-run the linear model. What happens to the estimates?</p>
</div>
</div>
<div id="residuals" class="section level3" number="8.3.5">
<h3>
<span class="header-section-number">8.3.5</span> Residuals<a class="anchor" aria-label="anchor" href="#residuals"><i class="fas fa-link"></i></a>
</h3>
<p>You can use the <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code> function to extract the error term for each each data point. This is the DV values, minus the estimates for the intercept and trial type. We'll make a density plot of the <a class="glossary" target="_blank" title="That part of an observation that cannot be captured by the statistical model, and thus is assumed to reflect unknown factors." href="https://psyteachr.github.io/glossary/r#residual-error">residuals</a> below and compare it to the normal distribution we used for the error term.</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">my_lm</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_function</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey60"</span>,
                fun <span class="op">=</span> <span class="va">dnorm</span>, n <span class="op">=</span> <span class="fl">101</span>,
                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">error_sd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">res</span>, color <span class="op">=</span> <span class="va">trial_type</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:res-density-plot"></span>
<img src="08-glm_files/figure-html/res-density-plot-1.png" alt="Model residuals should be approximately normally distributed for each group" width="100%"><p class="caption">
Figure 8.2: Model residuals should be approximately normally distributed for each group
</p>
</div>
<p>You can also compare the model residuals to the simulated error values. If the model is accurate, they should be almost identical. If the intercept estimate is slightly off, the points will be slightly above or below the black line. If the estimate for the effect of trial type is slightly off, there will be a small, systematic difference between residuals for congruent and incongruent trials.</p>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">error</span>, <span class="va">res</span>,color <span class="op">=</span> <span class="va">trial_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Model Residuals"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Simulated Error"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:res-err-plot"></span>
<img src="08-glm_files/figure-html/res-err-plot-1.png" alt="Model residuals should be very similar to the simulated error" width="100%"><p class="caption">
Figure 8.3: Model residuals should be very similar to the simulated error
</p>
</div>
<div class="try">
<p>What happens to the residuals if you fit a model that ignores trial type (e.g., <code><a href="https://rdrr.io/r/stats/lm.html">lm(Y ~ 1, data = dat)</a></code>)?</p>
</div>
</div>
<div id="predict" class="section level3" number="8.3.6">
<h3>
<span class="header-section-number">8.3.6</span> Predict New Values<a class="anchor" aria-label="anchor" href="#predict"><i class="fas fa-link"></i></a>
</h3>
<p>You can use the estimates from your model to predict new data points, given values for the model parameters. For this simple example, we just need to know the trial type to make a prediction.</p>
<p>For congruent trials, you would predict that a new data point would be equal to the intercept estimate plus the trial type estimate multiplied by 0.5 (the effect code for congruent trials).</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">int_est</span> <span class="op">&lt;-</span> <span class="va">my_lm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="st">"(Intercept)"</span><span class="op">]</span><span class="op">]</span>
<span class="va">tt_est</span>  <span class="op">&lt;-</span> <span class="va">my_lm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="st">"trial_type.e"</span><span class="op">]</span><span class="op">]</span>
<span class="va">tt_code</span> <span class="op">&lt;-</span> <span class="va">trial_types</span><span class="op">[[</span><span class="st">"congruent"</span><span class="op">]</span><span class="op">]</span>
<span class="va">new_congruent_RT</span> <span class="op">&lt;-</span> <span class="va">int_est</span> <span class="op">+</span> <span class="va">tt_est</span> <span class="op">*</span> <span class="va">tt_code</span>
<span class="va">new_congruent_RT</span></code></pre></div>
<pre><code>## [1] 819.1605</code></pre>
<p>You can also use the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function to do this more easily. The second argument is a data table with columns for the factors in the model and rows with the values that you want to use for the prediction.</p>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">my_lm</span>, newdata <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>trial_type.e <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##        1 
## 819.1605</code></pre>
<div class="info">
<p>If you look up this function using <code><a href="https://rdrr.io/r/stats/predict.html">?predict</a></code>, you will see that "The function invokes particular methods which depend on the class of the first argument."
What this means is that <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> works differently depending on whether you're predicting from the output of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> or other analysis functions. You can search for help on the lm version with <code><a href="https://rdrr.io/r/stats/predict.lm.html">?predict.lm</a></code>.</p>
</div>
</div>
<div id="coding-schemes" class="section level3" number="8.3.7">
<h3>
<span class="header-section-number">8.3.7</span> Coding Categorical Variables<a class="anchor" aria-label="anchor" href="#coding-schemes"><i class="fas fa-link"></i></a>
</h3>
<p>In the example above, we used <strong>effect coding</strong> for trial type. You can also use <strong>sum coding</strong>, which assigns +1 and -1 to the levels instead of +0.5 and -0.5. More commonly, you might want to use <strong>treatment coding</strong>, which assigns 0 to one level (usually a baseline or control condition) and 1 to the other level (usually a treatment or experimental condition).</p>
<p>Here we will add sum-coded and treatment-coded versions of <code>trial_type</code> to the dataset using the <code>recode()</code> function.</p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  trial_type.sum <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">trial_type</span>, <span class="st">"congruent"</span> <span class="op">=</span> <span class="op">+</span><span class="fl">1</span>, <span class="st">"incongruent"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,
  trial_type.tr <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">trial_type</span>, <span class="st">"congruent"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"incongruent"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>If you define named vectors with your levels and coding, you can use them with the <code>recode()</code> function if you expand them using <code>!!!</code>.</p>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tt_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"congruent"</span>   <span class="op">=</span> <span class="op">+</span><span class="fl">1</span>, 
            <span class="st">"incongruent"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">tt_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"congruent"</span>   <span class="op">=</span> <span class="fl">1</span>, 
           <span class="st">"incongruent"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
  trial_type.sum <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">trial_type</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">tt_sum</span><span class="op">)</span>,
  trial_type.tr <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">trial_type</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">tt_tr</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Here are the coefficients for the effect-coded version. They should be the same as those from the last analysis.</p>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">~</span> <span class="va">trial_type.e</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></code></pre></div>
<pre><code>##  (Intercept) trial_type.e 
##    788.19166     61.93773</code></pre>
<p>Here are the coefficients for the sum-coded version. This give the same results as effect coding, except the estimate for the categorical factor will be exactly half as large, as it represents the difference between each trial type and the hypothetical condition of 0 (the overall mean RT), rather than the difference between the two trial types.</p>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">~</span> <span class="va">trial_type.sum</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></code></pre></div>
<pre><code>##    (Intercept) trial_type.sum 
##      788.19166       30.96887</code></pre>
<p>Here are the coefficients for the treatment-coded version. The estimate for the categorical factor will be the same as in the effect-coded version, but the intercept will decrease. It will be equal to the intercept minus the estimate for trial type from the sum-coded version.</p>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">~</span> <span class="va">trial_type.tr</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></code></pre></div>
<pre><code>##   (Intercept) trial_type.tr 
##     757.22279      61.93773</code></pre>
</div>
</div>
<div id="test-rels" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Relationships among tests<a class="anchor" aria-label="anchor" href="#test-rels"><i class="fas fa-link"></i></a>
</h2>
<div id="t-test-t-test-glm" class="section level3" number="8.4.1">
<h3>
<span class="header-section-number">8.4.1</span> T-test {t-test-glm}<a class="anchor" aria-label="anchor" href="#t-test-t-test-glm"><i class="fas fa-link"></i></a>
</h3>
<p>The t-test is just a special, limited example of a general linear model.</p>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">~</span> <span class="va">trial_type.e</span>, data <span class="op">=</span> <span class="va">dat</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  RT by trial_type.e
## t = -4.2975, df = 198, p-value = 2.707e-05
## alternative hypothesis: true difference in means between group -0.5 and group 0.5 is not equal to 0
## 95 percent confidence interval:
##  -90.35945 -33.51601
## sample estimates:
## mean in group -0.5  mean in group 0.5 
##           757.2228           819.1605</code></pre>
<div class="try">
<p>What happens when you use other codings for trial type in the t-test above? Which coding maps onto the results of the t-test best?</p>
</div>
</div>
<div id="anova" class="section level3" number="8.4.2">
<h3>
<span class="header-section-number">8.4.2</span> ANOVA<a class="anchor" aria-label="anchor" href="#anova"><i class="fas fa-link"></i></a>
</h3>
<p>ANOVA is also a special, limited version of the linear model.</p>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">~</span> <span class="va">trial_type.e</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">my_aov</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##               Df    Sum Sq   Mean Sq  F value   Pr(&gt;F)    
## (Intercept)    1 124249219 124249219 11963.12  &lt; 2e-16 ***
## trial_type.e   1    191814    191814    18.47 2.71e-05 ***
## Residuals    198   2056432     10386                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>The easiest way to get parameters out of an analysis is to use the <code><a href="https://generics.r-lib.org/reference/tidy.html">broom::tidy()</a></code> function. This returns a tidy table that you can extract numbers of interest from. Here, we just want to get the F-value for the effect of trial_type. Compare the square root of this value to the t-value from the t-tests above.</p>
<div class="sourceCode" id="cb340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">my_aov</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 4.297498</code></pre>
</div>
</div>
<div id="understanding-anova" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Understanding ANOVA<a class="anchor" aria-label="anchor" href="#understanding-anova"><i class="fas fa-link"></i></a>
</h2>
<p>We'll walk through an example of a one-way ANOVA with the following equation:</p>
<p><span class="math inline">\(Y_{ij} = \mu + A_i + S(A)_{ij}\)</span></p>
<p>This means that each data point (<span class="math inline">\(Y_{ij}\)</span>) is predicted to be the sum of the grand mean (<span class="math inline">\(\mu\)</span>), plus the effect of factor A (<span class="math inline">\(A_i\)</span>), plus some residual error (<span class="math inline">\(S(A)_{ij}\)</span>).</p>
<div id="means-variability-and-deviation-scores" class="section level3" number="8.5.1">
<h3>
<span class="header-section-number">8.5.1</span> Means, Variability, and Deviation Scores<a class="anchor" aria-label="anchor" href="#means-variability-and-deviation-scores"><i class="fas fa-link"></i></a>
</h3>
<p>Let's create a simple simulation function so you can quickly create a two-sample dataset with specified Ns, means, and SDs.</p>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">two_sample</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">m1</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">m2</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">sd1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">sd2</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">m1</span>, <span class="va">sd1</span><span class="op">)</span>
  <span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">m2</span>, <span class="va">sd2</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span><span class="op">)</span>,
    grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Now we will use <code>two_sample()</code> to create a dataset <code>dat</code> with N=5 per group, means of -2 and +2, and SDs of 1 and 1 (yes, this is an effect size of d = 4).</p>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">two_sample</span><span class="op">(</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span>, <span class="op">+</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>You can calculate how each data point (<code>Y</code>) deviates from the overall sample mean (<span class="math inline">\(\hat{\mu}\)</span>), which is represented by the horizontal grey line below and the deviations are the vertical grey lines. You can also calculate how different each point is from its group-specific mean (<span class="math inline">\(\hat{A_i}\)</span>), which are represented by the horizontal coloured lines below and the deviations are the coloured vertical lines.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:deviation"></span>
<img src="08-glm_files/figure-html/deviation-1.png" alt="Deviations of each data point (Y) from the overall and group means" width="100%"><p class="caption">
Figure 8.4: Deviations of each data point (Y) from the overall and group means
</p>
</div>
<p>You can use these deviations to calculate variability between groups and within groups. ANOVA tests whether the variability between groups is larger than that within groups, accounting for the number of groups and observations.</p>
</div>
<div id="decomp" class="section level3" number="8.5.2">
<h3>
<span class="header-section-number">8.5.2</span> Decomposition matrices<a class="anchor" aria-label="anchor" href="#decomp"><i class="fas fa-link"></i></a>
</h3>
<p>We can use the estimation equations for a one-factor ANOVA to calculate the model components.</p>
<ul>
<li>
<code>mu</code> is the overall mean</li>
<li>
<code>a</code> is how different each group mean is from the overall mean</li>
<li>
<code>err</code> is residual error, calculated by subtracting <code>mu</code> and <code>a</code> from <code>Y</code>
</li>
</ul>
<p>This produces a <em>decomposition matrix</em>, a table with columns for <code>Y</code>, <code>mu</code>, <code>a</code>, and <code>err</code>.</p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">decomp</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">grp</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>     <span class="co"># calculate mu_hat</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">grp</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># calculate a_hat for each grp</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>err <span class="op">=</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">mu</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span>     <span class="co"># calculate residual error</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">Y</th>
<th align="left">grp</th>
<th align="right">mu</th>
<th align="right">a</th>
<th align="right">err</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">-1.4770938</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">-0.0643443</td>
</tr>
<tr class="even">
<td align="right">-2.9508741</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">-1.5381246</td>
</tr>
<tr class="odd">
<td align="right">-0.6376736</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">0.7750759</td>
</tr>
<tr class="even">
<td align="right">-1.7579084</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">-0.3451589</td>
</tr>
<tr class="odd">
<td align="right">-0.2401977</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">1.1725518</td>
</tr>
<tr class="even">
<td align="right">0.1968155</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">-1.4574367</td>
</tr>
<tr class="odd">
<td align="right">2.6308008</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">0.9765486</td>
</tr>
<tr class="even">
<td align="right">2.0293297</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">0.3750775</td>
</tr>
<tr class="odd">
<td align="right">2.1629037</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">0.5086516</td>
</tr>
<tr class="even">
<td align="right">1.2514112</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">-0.4028410</td>
</tr>
</tbody>
</table></div>
<p>Calculate sums of squares for <code>mu</code>, <code>a</code>, and <code>err</code>.</p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SS</span> <span class="op">&lt;-</span> <span class="va">decomp</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">mu</span><span class="op">*</span><span class="va">mu</span><span class="op">)</span>,
            a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">a</span><span class="op">*</span><span class="va">a</span><span class="op">)</span>,
            err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">err</span><span class="op">*</span><span class="va">err</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">mu</th>
<th align="right">a</th>
<th align="right">err</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.1458088</td>
<td align="right">23.51625</td>
<td align="right">8.104182</td>
</tr></tbody>
</table></div>
<p>If you've done everything right, <code>SS$mu + SS$a + SS$err</code> should equal the sum of squares for Y.</p>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SS_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">decomp</span><span class="op">$</span><span class="va">Y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">SS_Y</span>, <span class="va">SS</span><span class="op">$</span><span class="va">mu</span> <span class="op">+</span> <span class="va">SS</span><span class="op">$</span><span class="va">a</span> <span class="op">+</span> <span class="va">SS</span><span class="op">$</span><span class="va">err</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Divide each sum of squares by its corresponding degrees of freedom (df) to calculate mean squares. The df for <code>mu</code> is 1, the df for factor <code>a</code> is <code>K-1</code> (K is the number of groups), and the df for <code>err</code> is <code>N - K</code> (N is the number of observations).</p>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">grp</span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">1</span>, a <span class="op">=</span> <span class="va">K</span> <span class="op">-</span> <span class="fl">1</span>, err <span class="op">=</span> <span class="va">N</span> <span class="op">-</span> <span class="va">K</span><span class="op">)</span>
<span class="va">MS</span> <span class="op">&lt;-</span> <span class="va">SS</span> <span class="op">/</span> <span class="va">df</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">mu</th>
<th align="right">a</th>
<th align="right">err</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.1458088</td>
<td align="right">23.51625</td>
<td align="right">1.013023</td>
</tr></tbody>
</table></div>
<p>Then calculate an F-ratio for <code>mu</code> and <code>a</code> by dividing their mean squares by the error term mean square. Get the p-values that correspond to these F-values using the <code><a href="https://rdrr.io/r/stats/Fdist.html">pf()</a></code> function.</p>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">F_mu</span> <span class="op">&lt;-</span> <span class="va">MS</span><span class="op">$</span><span class="va">mu</span> <span class="op">/</span> <span class="va">MS</span><span class="op">$</span><span class="va">err</span>
<span class="va">F_a</span>  <span class="op">&lt;-</span> <span class="va">MS</span><span class="op">$</span><span class="va">a</span>  <span class="op">/</span> <span class="va">MS</span><span class="op">$</span><span class="va">err</span>
<span class="va">p_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">F_mu</span>, df1 <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="st">'mu'</span><span class="op">]</span>, df2 <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="st">'err'</span><span class="op">]</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">p_a</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">F_a</span>,  df1 <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="st">'a'</span><span class="op">]</span>,  df2 <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="st">'err'</span><span class="op">]</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Put everything into a data frame to display it in the same way as the ANOVA summary function.</p>
<div class="sourceCode" id="cb350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_calcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"grp"</span>, <span class="st">"Residuals"</span><span class="op">)</span>,
  Df <span class="op">=</span> <span class="va">df</span>,
  SS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">SS</span><span class="op">$</span><span class="va">mu</span>, <span class="va">SS</span><span class="op">$</span><span class="va">a</span>, <span class="va">SS</span><span class="op">$</span><span class="va">err</span><span class="op">)</span>,
  MS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MS</span><span class="op">$</span><span class="va">mu</span>, <span class="va">MS</span><span class="op">$</span><span class="va">a</span>, <span class="va">MS</span><span class="op">$</span><span class="va">err</span><span class="op">)</span>,
  F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">F_mu</span>, <span class="va">F_a</span>, <span class="cn">NA</span><span class="op">)</span>,
  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">p_mu</span>, <span class="va">p_a</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="left">term</th>
<th align="right">Df</th>
<th align="right">SS</th>
<th align="right">MS</th>
<th align="right">F</th>
<th align="right">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mu</td>
<td align="left">Intercept</td>
<td align="right">1</td>
<td align="right">0.146</td>
<td align="right">0.146</td>
<td align="right">0.144</td>
<td align="right">0.714</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="left">grp</td>
<td align="right">1</td>
<td align="right">23.516</td>
<td align="right">23.516</td>
<td align="right">23.214</td>
<td align="right">0.001</td>
</tr>
<tr class="odd">
<td align="left">err</td>
<td align="left">Residuals</td>
<td align="right">8</td>
<td align="right">8.104</td>
<td align="right">1.013</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table></div>
<p>Now run a one-way ANOVA on your results and compare it to what you obtained in your calculations.</p>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">grp</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## (Intercept)  1  0.146   0.146   0.144 0.71427   
## grp          1 23.516  23.516  23.214 0.00132 **
## Residuals    8  8.104   1.013                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="try">
<p>Using the code above, write your own function that takes a table of data and returns the ANOVA results table like above.</p>
</div>
</div>
</div>
<div id="glossary-glm" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Glossary<a class="anchor" aria-label="anchor" href="#glossary-glm"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="49%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="left">definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/c.html#categorical" class="glossary" target="_blank">categorical</a></td>
<td align="left">Data that can only take certain values, such as types of pet.</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/c.html#coding-scheme" class="glossary" target="_blank">coding scheme</a></td>
<td align="left">How to represent categorical variables with numbers for use in models</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/c.html#continuous" class="glossary" target="_blank">continuous</a></td>
<td align="left">Data that can take on any values between other existing values.</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/d.html#dependent-variable" class="glossary" target="_blank">dependent variable</a></td>
<td align="left">The target variable that is being analyzed, whose value is assumed to depend on other variables.</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/e.html#effect-code" class="glossary" target="_blank">effect code</a></td>
<td align="left">A coding scheme for categorical variables that contrasts each group mean with the mean of all the group means.</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/e.html#error-term" class="glossary" target="_blank">error term</a></td>
<td align="left">The term in a model that represents the difference between the actual and predicted values</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/g.html#general-linear-model" class="glossary" target="_blank">general linear model</a></td>
<td align="left">A mathematical model comparing how one or more independent variables affect a continuous dependent variable</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/i.html#independent-variable" class="glossary" target="_blank">independent variable</a></td>
<td align="left">A variable whose value is assumed to influence the value of a dependent variable.</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/n.html#normal-distribution" class="glossary" target="_blank">normal distribution</a></td>
<td align="left">A symmetric distribution of data where values near the centre are most probable.</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/r.html#residual-error" class="glossary" target="_blank">residual error</a></td>
<td align="left">That part of an observation that cannot be captured by the statistical model, and thus is assumed to reflect unknown factors.</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/s.html#simulation" class="glossary" target="_blank">simulation</a></td>
<td align="left">Generating data from summary parameters</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/s.html#standard-deviation" class="glossary" target="_blank">standard deviation</a></td>
<td align="left">A descriptive statistic that measures how spread out data are relative to the mean.</td>
</tr>
</tbody>
</table></div>
</div>
<div id="resources-glm" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> Further Resources<a class="anchor" aria-label="anchor" href="#resources-glm"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><a href="http://www.otago.ac.nz/psychology/otago039309.pdf">Jeff Miller and Patricia Haden, Statistical Analysis with the Linear Model (free online textbook)</a></li>
<li><a href="slides/08_glm_slides.pdf">lecture slides introducing the General Linear Model</a></li>
<li><a href="http://rstudio2.psy.gla.ac.uk/Dale/GLM">GLM shiny app</a></li>
<li><a href="http://rstudio2.psy.gla.ac.uk/Dale/fdist">F distribution</a></li>
</ul>
</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("webex-total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("webex-correct").length + " of " +
      document.getElementsByClassName("webex-solveme").length + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log(this.id);
  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' <a href="https://zenodo.org/badge/latestdoi/166541547"><img src="https://zenodo.org/badge/166541547.svg" alt="DOI"></a>';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );
});
</script><div class="chapter-nav">
<div class="prev"><a href="dplyr.html"><span class="header-section-number">7</span> Data Wrangling</a></div>
<div class="next"><a href="func.html"><span class="header-section-number">9</span> Iteration &amp; Functions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#glm"><span class="header-section-number">8</span> Introduction to GLM</a></li>
<li>
<a class="nav-link" href="#ilo-glm"><span class="header-section-number">8.1</span> Learning Objectives</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#basic-4">Basic</a></li>
<li><a class="nav-link" href="#intermediate-4">Intermediate</a></li>
</ul>
</li>
<li><a class="nav-link" href="#setup-glm"><span class="header-section-number">8.2</span> Setup</a></li>
<li>
<a class="nav-link" href="#glm-1"><span class="header-section-number">8.3</span> GLM</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#what-is-the-glm"><span class="header-section-number">8.3.1</span> What is the GLM?</a></li>
<li><a class="nav-link" href="#glm-components"><span class="header-section-number">8.3.2</span> Components</a></li>
<li><a class="nav-link" href="#sim-glm"><span class="header-section-number">8.3.3</span> Simulating data from GLM</a></li>
<li><a class="nav-link" href="#linear-regression"><span class="header-section-number">8.3.4</span> Linear Regression</a></li>
<li><a class="nav-link" href="#residuals"><span class="header-section-number">8.3.5</span> Residuals</a></li>
<li><a class="nav-link" href="#predict"><span class="header-section-number">8.3.6</span> Predict New Values</a></li>
<li><a class="nav-link" href="#coding-schemes"><span class="header-section-number">8.3.7</span> Coding Categorical Variables</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#test-rels"><span class="header-section-number">8.4</span> Relationships among tests</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#t-test-t-test-glm"><span class="header-section-number">8.4.1</span> T-test {t-test-glm}</a></li>
<li><a class="nav-link" href="#anova"><span class="header-section-number">8.4.2</span> ANOVA</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#understanding-anova"><span class="header-section-number">8.5</span> Understanding ANOVA</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#means-variability-and-deviation-scores"><span class="header-section-number">8.5.1</span> Means, Variability, and Deviation Scores</a></li>
<li><a class="nav-link" href="#decomp"><span class="header-section-number">8.5.2</span> Decomposition matrices</a></li>
</ul>
</li>
<li><a class="nav-link" href="#glossary-glm"><span class="header-section-number">8.6</span> Glossary</a></li>
<li><a class="nav-link" href="#resources-glm"><span class="header-section-number">8.7</span> Further Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/reprores-v2/blob/master/book/08-glm.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/reprores-v2/edit/master/book/08-glm.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Skills for Reproducible Research</strong>: v2" was written by . It was last built on 2021-09-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
