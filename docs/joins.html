<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 12 Data Relations | Data Skills</title>
  <meta name="description" content="This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows. Learning is reinforced through weekly assignments that involve working with different types of data.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 12 Data Relations | Data Skills" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows. Learning is reinforced through weekly assignments that involve working with different types of data." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Data Relations | Data Skills" />
  
  <meta name="twitter:description" content="This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows. Learning is reinforced through weekly assignments that involve working with different types of data." />
  

<meta name="author" content="Dale J Barr &amp; Lisa M. DeBruine">


<meta name="date" content="2019-01-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="class-notes-1.html">
<link rel="next" href="func.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-aims"><i class="fa fa-check"></i><b>1.1</b> Course Aims</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#intended-learning-outcomes"><i class="fa fa-check"></i><b>1.2</b> Intended Learning Outcomes</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#formative-exercises"><i class="fa fa-check"></i><b>1.3</b> Formative Exercises</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i><b>1.4</b> Resources</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#online-tutorials"><i class="fa fa-check"></i><b>1.4.1</b> Online tutorials</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#cheat-sheets"><i class="fa fa-check"></i><b>1.4.2</b> Cheat sheets</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#other"><i class="fa fa-check"></i><b>1.4.3</b> Other</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#resources-1"><i class="fa fa-check"></i><b>2.2</b> Resources</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>2.3</b> What is R?</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#interacting-with-r"><i class="fa fa-check"></i><b>2.4</b> Interacting with R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#rconsole"><i class="fa fa-check"></i><b>2.4.1</b> The Base R Console</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#rstudio_ide"><i class="fa fa-check"></i><b>2.4.2</b> The RStudio Integrated Development Environment (IDE)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#developing-reproducible-scripts"><i class="fa fa-check"></i><b>2.5</b> Developing reproducible scripts</a><ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#configure-rstudio-for-maximum-reproducibility"><i class="fa fa-check"></i><b>2.5.1</b> Configure RStudio for Maximum Reproducibility</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>2.5.2</b> Reproducible reports with RStudio and RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#typing-in-commands"><i class="fa fa-check"></i><b>2.6</b> Typing in commands</a><ul>
<li class="chapter" data-level="2.6.1" data-path="intro.html"><a href="intro.html#rcalc"><i class="fa fa-check"></i><b>2.6.1</b> Warming up: Use R as a calculator</a></li>
<li class="chapter" data-level="2.6.2" data-path="intro.html"><a href="intro.html#vars"><i class="fa fa-check"></i><b>2.6.2</b> Storing results in a variable</a></li>
<li class="chapter" data-level="2.6.3" data-path="intro.html"><a href="intro.html#whitespace"><i class="fa fa-check"></i><b>2.6.3</b> Whitespace</a></li>
<li class="chapter" data-level="2.6.4" data-path="intro.html"><a href="intro.html#the-workspace"><i class="fa fa-check"></i><b>2.6.4</b> The workspace</a></li>
<li class="chapter" data-level="2.6.5" data-path="intro.html"><a href="intro.html#vectors"><i class="fa fa-check"></i><b>2.6.5</b> Vectors</a></li>
<li class="chapter" data-level="2.6.6" data-path="intro.html"><a href="intro.html#function_syx"><i class="fa fa-check"></i><b>2.6.6</b> Function syntax</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#data_types"><i class="fa fa-check"></i><b>2.7</b> Some basic data types</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#add-on-packages"><i class="fa fa-check"></i><b>2.8</b> Add-on packages</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>2.9</b> Getting help</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>2.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro2.html"><a href="intro2.html"><i class="fa fa-check"></i><b>3</b> Introduction 2</a><ul>
<li class="chapter" data-level="3.1" data-path="intro2.html"><a href="intro2.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="intro2.html"><a href="intro2.html#resources-2"><i class="fa fa-check"></i><b>3.2</b> Resources</a></li>
<li class="chapter" data-level="3.3" data-path="intro2.html"><a href="intro2.html#project_org"><i class="fa fa-check"></i><b>3.3</b> Organizing a project</a><ul>
<li class="chapter" data-level="3.3.1" data-path="intro2.html"><a href="intro2.html#working-directory"><i class="fa fa-check"></i><b>3.3.1</b> Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="intro2.html"><a href="intro2.html#script_struct"><i class="fa fa-check"></i><b>3.4</b> Structuring your script</a></li>
<li class="chapter" data-level="3.5" data-path="intro.html"><a href="intro.html#data_types"><i class="fa fa-check"></i><b>3.5</b> Basic data types</a></li>
<li class="chapter" data-level="3.6" data-path="intro2.html"><a href="intro2.html#containers"><i class="fa fa-check"></i><b>3.6</b> Basic container types</a><ul>
<li class="chapter" data-level="3.6.1" data-path="intro.html"><a href="intro.html#vectors"><i class="fa fa-check"></i><b>3.6.1</b> Vectors</a></li>
<li class="chapter" data-level="3.6.2" data-path="intro2.html"><a href="intro2.html#ex_vector"><i class="fa fa-check"></i><b>3.6.2</b> Exercises</a></li>
<li class="chapter" data-level="3.6.3" data-path="intro2.html"><a href="intro2.html#lists"><i class="fa fa-check"></i><b>3.6.3</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="intro2.html"><a href="intro2.html#tables"><i class="fa fa-check"></i><b>3.7</b> Tabular data</a><ul>
<li class="chapter" data-level="3.7.1" data-path="intro2.html"><a href="intro2.html#viewing-your-tibble"><i class="fa fa-check"></i><b>3.7.1</b> Viewing your tibble</a></li>
<li class="chapter" data-level="3.7.2" data-path="intro2.html"><a href="intro2.html#accessing-rows-and-columns"><i class="fa fa-check"></i><b>3.7.2</b> Accessing rows and columns</a></li>
<li class="chapter" data-level="3.7.3" data-path="intro2.html"><a href="intro2.html#ex_tibble"><i class="fa fa-check"></i><b>3.7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="intro2.html"><a href="intro2.html#import_data"><i class="fa fa-check"></i><b>3.8</b> Importing data</a><ul>
<li class="chapter" data-level="3.8.1" data-path="intro2.html"><a href="intro2.html#writing-data"><i class="fa fa-check"></i><b>3.8.1</b> Writing Data</a></li>
<li class="chapter" data-level="3.8.2" data-path="intro2.html"><a href="intro2.html#ex_import"><i class="fa fa-check"></i><b>3.8.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="intro2.html"><a href="intro2.html#pipes"><i class="fa fa-check"></i><b>3.9</b> Pipes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>4</b> Data Visualisation</a><ul>
<li class="chapter" data-level="4.1" data-path="ggplot.html"><a href="ggplot.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ggplot.html"><a href="ggplot.html#basic"><i class="fa fa-check"></i><b>4.1.1</b> Basic</a></li>
<li class="chapter" data-level="4.1.2" data-path="ggplot.html"><a href="ggplot.html#intermediate"><i class="fa fa-check"></i><b>4.1.2</b> Intermediate</a></li>
<li class="chapter" data-level="4.1.3" data-path="ggplot.html"><a href="ggplot.html#advanced"><i class="fa fa-check"></i><b>4.1.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ggplot.html"><a href="ggplot.html#resources-3"><i class="fa fa-check"></i><b>4.2</b> Resources</a></li>
<li class="chapter" data-level="4.3" data-path="ggplot.html"><a href="ggplot.html#setup"><i class="fa fa-check"></i><b>4.3</b> Setup</a></li>
<li class="chapter" data-level="4.4" data-path="ggplot.html"><a href="ggplot.html#vartypes"><i class="fa fa-check"></i><b>4.4</b> Common Variable Combinations</a></li>
<li class="chapter" data-level="4.5" data-path="ggplot.html"><a href="ggplot.html#data"><i class="fa fa-check"></i><b>4.5</b> Data</a></li>
<li class="chapter" data-level="4.6" data-path="ggplot.html"><a href="ggplot.html#basic-plots"><i class="fa fa-check"></i><b>4.6</b> Basic Plots</a><ul>
<li class="chapter" data-level="4.6.1" data-path="ggplot.html"><a href="ggplot.html#geom_bar"><i class="fa fa-check"></i><b>4.6.1</b> Bar plot</a></li>
<li class="chapter" data-level="4.6.2" data-path="ggplot.html"><a href="ggplot.html#density-plot"><i class="fa fa-check"></i><b>4.6.2</b> Density plot</a></li>
<li class="chapter" data-level="4.6.3" data-path="ggplot.html"><a href="ggplot.html#geom_freqpoly"><i class="fa fa-check"></i><b>4.6.3</b> Frequency Polygons</a></li>
<li class="chapter" data-level="4.6.4" data-path="ggplot.html"><a href="ggplot.html#geom_histogram"><i class="fa fa-check"></i><b>4.6.4</b> Histogram</a></li>
<li class="chapter" data-level="4.6.5" data-path="ggplot.html"><a href="ggplot.html#geom_col"><i class="fa fa-check"></i><b>4.6.5</b> Column plot</a></li>
<li class="chapter" data-level="4.6.6" data-path="ggplot.html"><a href="ggplot.html#geom_boxplot"><i class="fa fa-check"></i><b>4.6.6</b> Boxplot</a></li>
<li class="chapter" data-level="4.6.7" data-path="ggplot.html"><a href="ggplot.html#geom_violin"><i class="fa fa-check"></i><b>4.6.7</b> Violin plot</a></li>
<li class="chapter" data-level="4.6.8" data-path="ggplot.html"><a href="ggplot.html#geom_point"><i class="fa fa-check"></i><b>4.6.8</b> Scatter plot</a></li>
<li class="chapter" data-level="4.6.9" data-path="ggplot.html"><a href="ggplot.html#geom_smooth"><i class="fa fa-check"></i><b>4.6.9</b> Line graph</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ggplot.html"><a href="ggplot.html#save-as-file"><i class="fa fa-check"></i><b>4.7</b> Save as File</a></li>
<li class="chapter" data-level="4.8" data-path="ggplot.html"><a href="ggplot.html#combination-plots"><i class="fa fa-check"></i><b>4.8</b> Combination Plots</a><ul>
<li class="chapter" data-level="4.8.1" data-path="ggplot.html"><a href="ggplot.html#violinbox-plot"><i class="fa fa-check"></i><b>4.8.1</b> Violinbox plot</a></li>
<li class="chapter" data-level="4.8.2" data-path="ggplot.html"><a href="ggplot.html#violin-jitter-plot"><i class="fa fa-check"></i><b>4.8.2</b> Violin-jitter plot</a></li>
<li class="chapter" data-level="4.8.3" data-path="ggplot.html"><a href="ggplot.html#scatter-line-graph"><i class="fa fa-check"></i><b>4.8.3</b> Scatter-line graph</a></li>
<li class="chapter" data-level="4.8.4" data-path="ggplot.html"><a href="ggplot.html#cowplot"><i class="fa fa-check"></i><b>4.8.4</b> Grid of plots</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ggplot.html"><a href="ggplot.html#overlap"><i class="fa fa-check"></i><b>4.9</b> Overlapping Data</a><ul>
<li class="chapter" data-level="4.9.1" data-path="ggplot.html"><a href="ggplot.html#discrete-data"><i class="fa fa-check"></i><b>4.9.1</b> Discrete Data</a></li>
<li class="chapter" data-level="4.9.2" data-path="ggplot.html"><a href="ggplot.html#viridis"><i class="fa fa-check"></i><b>4.9.2</b> Colours</a></li>
<li class="chapter" data-level="4.9.3" data-path="ggplot.html"><a href="ggplot.html#continuous-data"><i class="fa fa-check"></i><b>4.9.3</b> Continuous Data</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ggplot.html"><a href="ggplot.html#geom_tile"><i class="fa fa-check"></i><b>4.10</b> Heat map</a></li>
<li class="chapter" data-level="4.11" data-path="ggplot.html"><a href="ggplot.html#plotly"><i class="fa fa-check"></i><b>4.11</b> Interactive Plots</a></li>
<li class="chapter" data-level="4.12" data-path="ggplot.html"><a href="ggplot.html#exercises-1"><i class="fa fa-check"></i><b>4.12</b> Exercises</a><ul>
<li class="chapter" data-level="4.12.1" data-path="ggplot.html"><a href="ggplot.html#common-plots"><i class="fa fa-check"></i><b>4.12.1</b> Common Plots</a></li>
<li class="chapter" data-level="4.12.2" data-path="ggplot.html"><a href="ggplot.html#two-continuous-variables"><i class="fa fa-check"></i><b>4.12.2</b> Two continuous variables</a></li>
<li class="chapter" data-level="4.12.3" data-path="ggplot.html"><a href="ggplot.html#many-correlated-variables"><i class="fa fa-check"></i><b>4.12.3</b> Many correlated variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tidyr.html"><a href="tidyr.html"><i class="fa fa-check"></i><b>5</b> Tidy Data</a><ul>
<li class="chapter" data-level="5.1" data-path="tidyr.html"><a href="tidyr.html#learning-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a><ul>
<li class="chapter" data-level="5.1.1" data-path="tidyr.html"><a href="tidyr.html#basic-1"><i class="fa fa-check"></i><b>5.1.1</b> Basic</a></li>
<li class="chapter" data-level="5.1.2" data-path="tidyr.html"><a href="tidyr.html#intermediate-1"><i class="fa fa-check"></i><b>5.1.2</b> Intermediate</a></li>
<li class="chapter" data-level="5.1.3" data-path="tidyr.html"><a href="tidyr.html#advanced-1"><i class="fa fa-check"></i><b>5.1.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tidyr.html"><a href="tidyr.html#prep"><i class="fa fa-check"></i><b>5.2</b> Prep</a></li>
<li class="chapter" data-level="5.3" data-path="tidyr.html"><a href="tidyr.html#resources-4"><i class="fa fa-check"></i><b>5.3</b> Resources</a></li>
<li class="chapter" data-level="5.4" data-path="tidyr.html"><a href="tidyr.html#formative-exercise"><i class="fa fa-check"></i><b>5.4</b> Formative exercise</a></li>
<li class="chapter" data-level="5.5" data-path="tidyr.html"><a href="tidyr.html#class-notes"><i class="fa fa-check"></i><b>5.5</b> Class Notes</a><ul>
<li class="chapter" data-level="5.5.1" data-path="tidyr.html"><a href="tidyr.html#setup-1"><i class="fa fa-check"></i><b>5.5.1</b> Setup</a></li>
<li class="chapter" data-level="5.5.2" data-path="tidyr.html"><a href="tidyr.html#load-data"><i class="fa fa-check"></i><b>5.5.2</b> Load Data</a></li>
<li class="chapter" data-level="5.5.3" data-path="tidyr.html"><a href="tidyr.html#pipes-1"><i class="fa fa-check"></i><b>5.5.3</b> Pipes</a></li>
<li class="chapter" data-level="5.5.4" data-path="tidyr.html"><a href="tidyr.html#gather"><i class="fa fa-check"></i><b>5.5.4</b> gather()</a></li>
<li class="chapter" data-level="5.5.5" data-path="tidyr.html"><a href="tidyr.html#separate"><i class="fa fa-check"></i><b>5.5.5</b> separate()</a></li>
<li class="chapter" data-level="5.5.6" data-path="tidyr.html"><a href="tidyr.html#spread"><i class="fa fa-check"></i><b>5.5.6</b> spread()</a></li>
<li class="chapter" data-level="5.5.7" data-path="tidyr.html"><a href="tidyr.html#unite"><i class="fa fa-check"></i><b>5.5.7</b> unite()</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="tidyr.html"><a href="tidyr.html#exercises-2"><i class="fa fa-check"></i><b>5.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Data Wrangling</a></li>
<li class="chapter" data-level="7" data-path="learning-objectives-4.html"><a href="learning-objectives-4.html"><i class="fa fa-check"></i><b>7</b> Learning Objectives</a><ul>
<li class="chapter" data-level="7.1" data-path="learning-objectives-4.html"><a href="learning-objectives-4.html#basic-2"><i class="fa fa-check"></i><b>7.1</b> Basic</a></li>
<li class="chapter" data-level="7.2" data-path="learning-objectives-4.html"><a href="learning-objectives-4.html#intermediateadvanced"><i class="fa fa-check"></i><b>7.2</b> Intermediate/Advanced</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="prep-1.html"><a href="prep-1.html"><i class="fa fa-check"></i><b>8</b> Prep</a></li>
<li class="chapter" data-level="9" data-path="resources-5.html"><a href="resources-5.html"><i class="fa fa-check"></i><b>9</b> Resources</a></li>
<li class="chapter" data-level="10" data-path="formative-exercises-1.html"><a href="formative-exercises-1.html"><i class="fa fa-check"></i><b>10</b> Formative exercises</a></li>
<li class="chapter" data-level="11" data-path="class-notes-1.html"><a href="class-notes-1.html"><i class="fa fa-check"></i><b>11</b> Class notes</a><ul>
<li class="chapter" data-level="11.1" data-path="class-notes-1.html"><a href="class-notes-1.html#setup-2"><i class="fa fa-check"></i><b>11.1</b> Setup</a></li>
<li class="chapter" data-level="11.2" data-path="class-notes-1.html"><a href="class-notes-1.html#in-class-tasks"><i class="fa fa-check"></i><b>11.2</b> In-class tasks</a><ul>
<li class="chapter" data-level="11.2.1" data-path="class-notes-1.html"><a href="class-notes-1.html#easy"><i class="fa fa-check"></i><b>11.2.1</b> Easy</a></li>
<li class="chapter" data-level="11.2.2" data-path="class-notes-1.html"><a href="class-notes-1.html#intermediate-2"><i class="fa fa-check"></i><b>11.2.2</b> Intermediate</a></li>
<li class="chapter" data-level="11.2.3" data-path="class-notes-1.html"><a href="class-notes-1.html#advanced-2"><i class="fa fa-check"></i><b>11.2.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="class-notes-1.html"><a href="class-notes-1.html#other-things-you-can-try-the-disgust-dataset"><i class="fa fa-check"></i><b>11.3</b> Other things you can try: The <code>disgust</code> dataset</a><ul>
<li class="chapter" data-level="11.3.1" data-path="class-notes-1.html"><a href="class-notes-1.html#select"><i class="fa fa-check"></i><b>11.3.1</b> select()</a></li>
<li class="chapter" data-level="11.3.2" data-path="class-notes-1.html"><a href="class-notes-1.html#select-helpers"><i class="fa fa-check"></i><b>11.3.2</b> select() helpers</a></li>
<li class="chapter" data-level="11.3.3" data-path="class-notes-1.html"><a href="class-notes-1.html#filter"><i class="fa fa-check"></i><b>11.3.3</b> filter()</a></li>
<li class="chapter" data-level="11.3.4" data-path="class-notes-1.html"><a href="class-notes-1.html#arrange"><i class="fa fa-check"></i><b>11.3.4</b> arrange()</a></li>
<li class="chapter" data-level="11.3.5" data-path="class-notes-1.html"><a href="class-notes-1.html#mutate"><i class="fa fa-check"></i><b>11.3.5</b> mutate()</a></li>
<li class="chapter" data-level="11.3.6" data-path="class-notes-1.html"><a href="class-notes-1.html#summarise"><i class="fa fa-check"></i><b>11.3.6</b> summarise()</a></li>
<li class="chapter" data-level="11.3.7" data-path="class-notes-1.html"><a href="class-notes-1.html#group_by"><i class="fa fa-check"></i><b>11.3.7</b> group_by()</a></li>
<li class="chapter" data-level="11.3.8" data-path="class-notes-1.html"><a href="class-notes-1.html#all-together"><i class="fa fa-check"></i><b>11.3.8</b> All Together</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="joins.html"><a href="joins.html"><i class="fa fa-check"></i><b>12</b> Data Relations</a><ul>
<li class="chapter" data-level="12.1" data-path="joins.html"><a href="joins.html#learning-objectives-5"><i class="fa fa-check"></i><b>12.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="12.2" data-path="joins.html"><a href="joins.html#prep-2"><i class="fa fa-check"></i><b>12.2</b> Prep</a></li>
<li class="chapter" data-level="12.3" data-path="joins.html"><a href="joins.html#resources-6"><i class="fa fa-check"></i><b>12.3</b> Resources</a></li>
<li class="chapter" data-level="12.4" data-path="joins.html"><a href="joins.html#formative-exercises-2"><i class="fa fa-check"></i><b>12.4</b> Formative exercises</a></li>
<li class="chapter" data-level="12.5" data-path="joins.html"><a href="joins.html#class-notes-2"><i class="fa fa-check"></i><b>12.5</b> Class Notes</a><ul>
<li class="chapter" data-level="12.5.1" data-path="joins.html"><a href="joins.html#setup-3"><i class="fa fa-check"></i><b>12.5.1</b> Setup</a></li>
<li class="chapter" data-level="12.5.2" data-path="joins.html"><a href="joins.html#data-1"><i class="fa fa-check"></i><b>12.5.2</b> Data</a></li>
<li class="chapter" data-level="12.5.3" data-path="joins.html"><a href="joins.html#left_join"><i class="fa fa-check"></i><b>12.5.3</b> left_join()</a></li>
<li class="chapter" data-level="12.5.4" data-path="joins.html"><a href="joins.html#right_join"><i class="fa fa-check"></i><b>12.5.4</b> right_join()</a></li>
<li class="chapter" data-level="12.5.5" data-path="joins.html"><a href="joins.html#inner_join"><i class="fa fa-check"></i><b>12.5.5</b> inner_join()</a></li>
<li class="chapter" data-level="12.5.6" data-path="joins.html"><a href="joins.html#full_join"><i class="fa fa-check"></i><b>12.5.6</b> full_join()</a></li>
<li class="chapter" data-level="12.5.7" data-path="joins.html"><a href="joins.html#semi_join"><i class="fa fa-check"></i><b>12.5.7</b> semi_join()</a></li>
<li class="chapter" data-level="12.5.8" data-path="joins.html"><a href="joins.html#anti_join"><i class="fa fa-check"></i><b>12.5.8</b> anti_join()</a></li>
<li class="chapter" data-level="12.5.9" data-path="joins.html"><a href="joins.html#bind_rows"><i class="fa fa-check"></i><b>12.5.9</b> bind_rows()</a></li>
<li class="chapter" data-level="12.5.10" data-path="joins.html"><a href="joins.html#bind_cols"><i class="fa fa-check"></i><b>12.5.10</b> bind_cols()</a></li>
<li class="chapter" data-level="12.5.11" data-path="joins.html"><a href="joins.html#intersect"><i class="fa fa-check"></i><b>12.5.11</b> intersect()</a></li>
<li class="chapter" data-level="12.5.12" data-path="joins.html"><a href="joins.html#union"><i class="fa fa-check"></i><b>12.5.12</b> union()</a></li>
<li class="chapter" data-level="12.5.13" data-path="joins.html"><a href="joins.html#setdiff"><i class="fa fa-check"></i><b>12.5.13</b> setdiff()</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="joins.html"><a href="joins.html#exercises-3"><i class="fa fa-check"></i><b>12.6</b> Exercises</a><ul>
<li class="chapter" data-level="12.6.1" data-path="joins.html"><a href="joins.html#mutating-joins"><i class="fa fa-check"></i><b>12.6.1</b> Mutating joins</a></li>
<li class="chapter" data-level="12.6.2" data-path="joins.html"><a href="joins.html#filtering-joins"><i class="fa fa-check"></i><b>12.6.2</b> Filtering joins</a></li>
<li class="chapter" data-level="12.6.3" data-path="joins.html"><a href="joins.html#binding-and-sets"><i class="fa fa-check"></i><b>12.6.3</b> Binding and sets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="func.html"><a href="func.html"><i class="fa fa-check"></i><b>13</b> Iteration &amp; Functions</a><ul>
<li class="chapter" data-level="13.1" data-path="func.html"><a href="func.html#learning-objectives-6"><i class="fa fa-check"></i><b>13.1</b> Learning Objectives</a><ul>
<li class="chapter" data-level="13.1.1" data-path="func.html"><a href="func.html#basic-3"><i class="fa fa-check"></i><b>13.1.1</b> Basic</a></li>
<li class="chapter" data-level="13.1.2" data-path="func.html"><a href="func.html#intermediate-3"><i class="fa fa-check"></i><b>13.1.2</b> Intermediate</a></li>
<li class="chapter" data-level="13.1.3" data-path="func.html"><a href="func.html#advanced-3"><i class="fa fa-check"></i><b>13.1.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="func.html"><a href="func.html#prep-3"><i class="fa fa-check"></i><b>13.2</b> Prep</a></li>
<li class="chapter" data-level="13.3" data-path="func.html"><a href="func.html#resources-7"><i class="fa fa-check"></i><b>13.3</b> Resources</a></li>
<li class="chapter" data-level="13.4" data-path="func.html"><a href="func.html#formative-exercises-3"><i class="fa fa-check"></i><b>13.4</b> Formative exercises</a></li>
<li class="chapter" data-level="13.5" data-path="func.html"><a href="func.html#class-notes-3"><i class="fa fa-check"></i><b>13.5</b> Class Notes</a><ul>
<li class="chapter" data-level="13.5.1" data-path="func.html"><a href="func.html#iteration-functions"><i class="fa fa-check"></i><b>13.5.1</b> Iteration functions</a></li>
<li class="chapter" data-level="13.5.2" data-path="func.html"><a href="func.html#custom-functions"><i class="fa fa-check"></i><b>13.5.2</b> Custom functions</a></li>
<li class="chapter" data-level="13.5.3" data-path="func.html"><a href="func.html#iterating-your-own-functions"><i class="fa fa-check"></i><b>13.5.3</b> Iterating your own functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sim.html"><a href="sim.html"><i class="fa fa-check"></i><b>14</b> Probability &amp; Simulation</a><ul>
<li class="chapter" data-level="14.1" data-path="sim.html"><a href="sim.html#learning-objectives-7"><i class="fa fa-check"></i><b>14.1</b> Learning Objectives</a><ul>
<li class="chapter" data-level="14.1.1" data-path="sim.html"><a href="sim.html#basic-4"><i class="fa fa-check"></i><b>14.1.1</b> Basic</a></li>
<li class="chapter" data-level="14.1.2" data-path="sim.html"><a href="sim.html#intermediate-4"><i class="fa fa-check"></i><b>14.1.2</b> Intermediate</a></li>
<li class="chapter" data-level="14.1.3" data-path="sim.html"><a href="sim.html#advanced-4"><i class="fa fa-check"></i><b>14.1.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="sim.html"><a href="sim.html#prep-4"><i class="fa fa-check"></i><b>14.2</b> Prep</a></li>
<li class="chapter" data-level="14.3" data-path="sim.html"><a href="sim.html#resources-8"><i class="fa fa-check"></i><b>14.3</b> Resources</a></li>
<li class="chapter" data-level="14.4" data-path="sim.html"><a href="sim.html#formative-exercises-4"><i class="fa fa-check"></i><b>14.4</b> Formative exercises</a></li>
<li class="chapter" data-level="14.5" data-path="sim.html"><a href="sim.html#class-notes-4"><i class="fa fa-check"></i><b>14.5</b> Class Notes</a><ul>
<li class="chapter" data-level="14.5.1" data-path="sim.html"><a href="sim.html#uniform-distribution"><i class="fa fa-check"></i><b>14.5.1</b> Uniform Distribution</a></li>
<li class="chapter" data-level="14.5.2" data-path="sim.html"><a href="sim.html#binomial-distribution"><i class="fa fa-check"></i><b>14.5.2</b> Binomial Distribution</a></li>
<li class="chapter" data-level="14.5.3" data-path="sim.html"><a href="sim.html#normal-distribution"><i class="fa fa-check"></i><b>14.5.3</b> Normal Distribution</a></li>
<li class="chapter" data-level="14.5.4" data-path="sim.html"><a href="sim.html#multivariate-normal"><i class="fa fa-check"></i><b>14.5.4</b> Multivariate Normal</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="sim.html"><a href="sim.html#example"><i class="fa fa-check"></i><b>14.6</b> Example</a><ul>
<li class="chapter" data-level="14.6.1" data-path="sim.html"><a href="sim.html#load-wrangle"><i class="fa fa-check"></i><b>14.6.1</b> Load &amp; wrangle</a></li>
<li class="chapter" data-level="14.6.2" data-path="sim.html"><a href="sim.html#plot"><i class="fa fa-check"></i><b>14.6.2</b> Plot</a></li>
<li class="chapter" data-level="14.6.3" data-path="sim.html"><a href="sim.html#get-means-and-sds"><i class="fa fa-check"></i><b>14.6.3</b> Get means and SDs</a></li>
<li class="chapter" data-level="14.6.4" data-path="sim.html"><a href="sim.html#simulate-a-population"><i class="fa fa-check"></i><b>14.6.4</b> Simulate a population</a></li>
<li class="chapter" data-level="14.6.5" data-path="sim.html"><a href="sim.html#analyse-simulated-data"><i class="fa fa-check"></i><b>14.6.5</b> Analyse simulated data</a></li>
<li class="chapter" data-level="14.6.6" data-path="sim.html"><a href="sim.html#replicate-simulation"><i class="fa fa-check"></i><b>14.6.6</b> Replicate simulation</a></li>
<li class="chapter" data-level="14.6.7" data-path="sim.html"><a href="sim.html#one-tailed-prediction"><i class="fa fa-check"></i><b>14.6.7</b> One-tailed prediction</a></li>
<li class="chapter" data-level="14.6.8" data-path="sim.html"><a href="sim.html#range-of-sample-sizes"><i class="fa fa-check"></i><b>14.6.8</b> Range of sample sizes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>15</b> Introduction to GLM</a><ul>
<li class="chapter" data-level="15.1" data-path="glm.html"><a href="glm.html#learning-objectives-8"><i class="fa fa-check"></i><b>15.1</b> Learning Objectives</a><ul>
<li class="chapter" data-level="15.1.1" data-path="glm.html"><a href="glm.html#basic-5"><i class="fa fa-check"></i><b>15.1.1</b> Basic</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="glm.html"><a href="glm.html#resources-9"><i class="fa fa-check"></i><b>15.2</b> Resources</a></li>
<li class="chapter" data-level="15.3" data-path="glm.html"><a href="glm.html#class-notes-5"><i class="fa fa-check"></i><b>15.3</b> Class Notes</a></li>
<li class="chapter" data-level="15.4" data-path="glm.html"><a href="glm.html#additional-take-home-formative-exercises"><i class="fa fa-check"></i><b>15.4</b> Additional Take-Home Formative Exercises</a></li>
<li class="chapter" data-level="15.5" data-path="glm.html"><a href="glm.html#in-class-exercises"><i class="fa fa-check"></i><b>15.5</b> In-Class Exercises</a><ul>
<li class="chapter" data-level="15.5.1" data-path="glm.html"><a href="glm.html#relationship-between-t-test-anova-and-linear-regression"><i class="fa fa-check"></i><b>15.5.1</b> Relationship between t-test, ANOVA, and linear regression</a></li>
<li class="chapter" data-level="15.5.2" data-path="glm.html"><a href="glm.html#understanding-decomposition-matrices"><i class="fa fa-check"></i><b>15.5.2</b> Understanding decomposition matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="repro.html"><a href="repro.html"><i class="fa fa-check"></i><b>16</b> Reproducible Workflows</a><ul>
<li class="chapter" data-level="16.1" data-path="repro.html"><a href="repro.html#learning-objectives-9"><i class="fa fa-check"></i><b>16.1</b> Learning Objectives</a><ul>
<li class="chapter" data-level="16.1.1" data-path="repro.html"><a href="repro.html#basic-6"><i class="fa fa-check"></i><b>16.1.1</b> Basic</a></li>
<li class="chapter" data-level="16.1.2" data-path="repro.html"><a href="repro.html#intermediate-5"><i class="fa fa-check"></i><b>16.1.2</b> Intermediate</a></li>
<li class="chapter" data-level="16.1.3" data-path="repro.html"><a href="repro.html#advanced-5"><i class="fa fa-check"></i><b>16.1.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="repro.html"><a href="repro.html#prep-5"><i class="fa fa-check"></i><b>16.2</b> Prep</a></li>
<li class="chapter" data-level="16.3" data-path="repro.html"><a href="repro.html#resources-10"><i class="fa fa-check"></i><b>16.3</b> Resources</a></li>
<li class="chapter" data-level="16.4" data-path="repro.html"><a href="repro.html#class-notes-6"><i class="fa fa-check"></i><b>16.4</b> Class Notes</a><ul>
<li class="chapter" data-level="16.4.1" data-path="repro.html"><a href="repro.html#r-markdown"><i class="fa fa-check"></i><b>16.4.1</b> R Markdown</a></li>
<li class="chapter" data-level="16.4.2" data-path="repro.html"><a href="repro.html#knitr-options"><i class="fa fa-check"></i><b>16.4.2</b> knitr options</a></li>
<li class="chapter" data-level="16.4.3" data-path="repro.html"><a href="repro.html#yaml-header"><i class="fa fa-check"></i><b>16.4.3</b> YAML Header</a></li>
<li class="chapter" data-level="16.4.4" data-path="repro.html"><a href="repro.html#toc-and-document-headers"><i class="fa fa-check"></i><b>16.4.4</b> TOC and Document Headers</a></li>
<li class="chapter" data-level="16.4.5" data-path="repro.html"><a href="repro.html#code-chunks"><i class="fa fa-check"></i><b>16.4.5</b> Code Chunks</a></li>
<li class="chapter" data-level="16.4.6" data-path="repro.html"><a href="repro.html#bibliography"><i class="fa fa-check"></i><b>16.4.6</b> Bibliography</a></li>
<li class="chapter" data-level="16.4.7" data-path="repro.html"><a href="repro.html#output-formats"><i class="fa fa-check"></i><b>16.4.7</b> Output Formats</a></li>
<li class="chapter" data-level="16.4.8" data-path="repro.html"><a href="repro.html#computational-reproducibility"><i class="fa fa-check"></i><b>16.4.8</b> Computational Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="repro.html"><a href="repro.html#references"><i class="fa fa-check"></i><b>16.5</b> References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Skills</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="joins" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Data Relations</h1>
<div id="learning-objectives-5" class="section level2 tabset">
<h2><span class="header-section-number">12.1</span> Learning Objectives</h2>
<ol style="list-style-type: decimal">
<li>Be able to use the 4 mutating join verbs:
<ul>
<li><a href="joins.html#left_join"><code>left_join()</code></a></li>
<li><a href="joins.html#right_join"><code>right_join()</code></a></li>
<li><a href="joins.html#inner_join"><code>inner_join()</code></a></li>
<li><a href="joins.html#full_join"><code>full_join()</code></a></li>
</ul></li>
<li>Be able to use the 2 binding join verbs:
<ul>
<li><a href="joins.html#bind_rows"><code>bind_rows()</code></a></li>
<li><a href="joins.html#bind_cols"><code>bind_cols()</code></a></li>
</ul></li>
<li>Be able to use the 2 filtering join verbs:
<ul>
<li><a href="joins.html#semi_join"><code>semi_join()</code></a></li>
<li><a href="joins.html#anti_join"><code>anti_join()</code></a></li>
</ul></li>
<li>Be able to use the 3 set operations:
<ul>
<li><a href="joins.html#intersect"><code>intersect()</code></a></li>
<li><a href="joins.html#union"><code>union()</code></a></li>
<li><a href="joins.html#setdiff"><code>setdiff()</code></a></li>
</ul></li>
</ol>
</div>
<div id="prep-2" class="section level2">
<h2><span class="header-section-number">12.2</span> Prep</h2>
<ul>
<li>Read <a href="http://r4ds.had.co.nz/relational-data.html">Chapter 13: Relational Data</a> in <em>R for Data Science</em></li>
</ul>
</div>
<div id="resources-6" class="section level2">
<h2><span class="header-section-number">12.3</span> Resources</h2>
<ul>
<li><a href="http://stat545.com/bit001_dplyr-cheatsheet.html">Cheatsheet for dplyr join functions</a></li>
</ul>
</div>
<div id="formative-exercises-2" class="section level2">
<h2><span class="header-section-number">12.4</span> Formative exercises</h2>
<p>Download the <a href="formative_exercises/06_joins_stub.Rmd">formative exercises</a>. See the <a href="formative_exercises/06_joins_answers.Rmd">answers</a> only after you’ve attempted all the questions.</p>
</div>
<div id="class-notes-2" class="section level2">
<h2><span class="header-section-number">12.5</span> Class Notes</h2>
<ul>
<li><a href="slides/05_joins_slides.pdf">Lecture slides on dplyr two-table verbs</a></li>
</ul>
<div id="setup-3" class="section level3">
<h3><span class="header-section-number">12.5.1</span> Setup</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># libraries needed for these examples</span>
<span class="kw">library</span>(tidyverse)</code></pre></div>
<p>All the joins have this basic syntax:</p>
<p><code>****_join(x, y, by = NULL, suffix = c(&quot;.x&quot;, &quot;.y&quot;)</code></p>
<ul>
<li><code>x</code> = the first (left) table</li>
<li><code>y</code> = the second (right) table</li>
<li><code>by</code> = what columns to match on. If you leave this blank, it will match on all columns with the same names in the two tables.</li>
<li><code>suffix</code> = if columns have the same name in the two tables, but you aren’t joining by them, they get a suffix to make them unambiguous. This defaults to “.x” and “.y”, but you can change it to something more meaningful.</li>
</ul>
</div>
<div id="data-1" class="section level3">
<h3><span class="header-section-number">12.5.2</span> Data</h3>
<p>First, we’ll create two small data tables.</p>
<p><code>subject</code> has id, sex and age for subjects 1-5. Age and sex are missing for subject 3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subject &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">id =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>),
  <span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>),
  <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">22</span>, <span class="ot">NA</span>, <span class="dv">19</span>, <span class="dv">18</span>)
)

subject</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##      id sex     age
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 m        19
## 2     2 m        22
## 3     3 &lt;NA&gt;     NA
## 4     4 f        19
## 5     5 f        18</code></pre>
<p><code>exp</code> has subject id and the score from an experiment. Some subjects are missing, some completed twice, and some are not in the subject table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">id =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>),
  <span class="dt">score =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">3</span>)
)

exp</code></pre></div>
<pre><code>## # A tibble: 9 x 2
##      id score
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     2    10
## 2     3    18
## 3     4    21
## 4     4    23
## 5     5     9
## 6     5    11
## 7     6    11
## 8     6    12
## 9     7     3</code></pre>
</div>
<div id="left_join" class="section level3">
<h3><span class="header-section-number">12.5.3</span> left_join()</h3>
<p><a name="left_join"></a></p>
<p><img src='images/joins/left_join.png' class='join'> A <code>left_join</code> keeps all the data from the first (left) table and joins anything that matches from the second (right) table. If the right table has more than one match for a row in the right table, there will be more than one row in the joined table (see ids 4 and 5).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">left_join</span>(subject, exp, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 7 x 4
##      id sex     age score
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 m        19    NA
## 2     2 m        22    10
## 3     3 &lt;NA&gt;     NA    18
## 4     4 f        19    21
## 5     4 f        19    23
## 6     5 f        18     9
## 7     5 f        18    11</code></pre>
<p>You can leave out the <code>by</code> argument if you’re matching on all of the columns with the same name, but it’s good practice to always specify it so your code is robust to changes in the loaded data.</p>
<p><img src='images/joins/left_join_rev.png' class='join'> The order of tables is swapped here, so the result is all rows from the <code>exp</code> table joined to any matching rows from the <code>subject</code> table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">left_join</span>(exp, subject, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 9 x 4
##      id score sex     age
##   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     2    10 m        22
## 2     3    18 &lt;NA&gt;     NA
## 3     4    21 f        19
## 4     4    23 f        19
## 5     5     9 f        18
## 6     5    11 f        18
## 7     6    11 &lt;NA&gt;     NA
## 8     6    12 &lt;NA&gt;     NA
## 9     7     3 &lt;NA&gt;     NA</code></pre>
</div>
<div id="right_join" class="section level3">
<h3><span class="header-section-number">12.5.4</span> right_join()</h3>
<p><a name="right_join"></a></p>
<p><img src='images/joins/right_join.png' class='join'> A <code>right_join</code> keeps all the data from the second (right) table and joins anything that matches from the first (left) table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">right_join</span>(subject, exp, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 9 x 4
##      id sex     age score
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     2 m        22    10
## 2     3 &lt;NA&gt;     NA    18
## 3     4 f        19    21
## 4     4 f        19    23
## 5     5 f        18     9
## 6     5 f        18    11
## 7     6 &lt;NA&gt;     NA    11
## 8     6 &lt;NA&gt;     NA    12
## 9     7 &lt;NA&gt;     NA     3</code></pre>
<p class="alert alert-info">
This table has the same information as <code>left_join(exp, subject, by = &quot;id&quot;)</code>, but the columns are in a different order (left table, then right table).
</p>
</div>
<div id="inner_join" class="section level3">
<h3><span class="header-section-number">12.5.5</span> inner_join()</h3>
<p><a name="inner_join"></a></p>
<p><img src='images/joins/inner_join.png' class='join'> An <code>inner_join</code> returns all the rows that have a match in the other table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">inner_join</span>(subject, exp, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##      id sex     age score
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     2 m        22    10
## 2     3 &lt;NA&gt;     NA    18
## 3     4 f        19    21
## 4     4 f        19    23
## 5     5 f        18     9
## 6     5 f        18    11</code></pre>
</div>
<div id="full_join" class="section level3">
<h3><span class="header-section-number">12.5.6</span> full_join()</h3>
<p><a name="full_join"></a></p>
<p><img src='images/joins/full_join.png' class='join'> A <code>full_join</code> lets you join up rows in two tables while keeping all of the information from both tables. If a row doesn’t have a match in the other table, the other table’s column values are set to <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">full_join</span>(subject, exp, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 10 x 4
##       id sex     age score
##    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1 m        19    NA
##  2     2 m        22    10
##  3     3 &lt;NA&gt;     NA    18
##  4     4 f        19    21
##  5     4 f        19    23
##  6     5 f        18     9
##  7     5 f        18    11
##  8     6 &lt;NA&gt;     NA    11
##  9     6 &lt;NA&gt;     NA    12
## 10     7 &lt;NA&gt;     NA     3</code></pre>
</div>
<div id="semi_join" class="section level3">
<h3><span class="header-section-number">12.5.7</span> semi_join()</h3>
<p><a name="semi_join"></a></p>
<p><img src='images/joins/semi_join.png' class='join'> A <code>semi_join</code> returns all rows from the left table where there are matching values in the right table, keeping just columns from the left table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">semi_join</span>(subject, exp, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 4 x 3
##      id sex     age
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     2 m        22
## 2     3 &lt;NA&gt;     NA
## 3     4 f        19
## 4     5 f        18</code></pre>
<p class="alert alert-info">
Unlike an inner join, a semi join will never duplicate the rows in the left table if there is more than one maching row in the right table.
</p>
<p><img src='images/joins/semi_join_rev.png' class='join'> Order matters in a semi join.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">semi_join</span>(exp, subject, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 2
##      id score
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     2    10
## 2     3    18
## 3     4    21
## 4     4    23
## 5     5     9
## 6     5    11</code></pre>
</div>
<div id="anti_join" class="section level3">
<h3><span class="header-section-number">12.5.8</span> anti_join()</h3>
<p><a name="anti_join"></a></p>
<p><img src='images/joins/anti_join.png' class='join'> A <code>anti_join</code> return all rows from the left table where there are <em>not</em> matching values in the right table, keeping just columns from the left table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anti_join</span>(subject, exp, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 3
##      id sex     age
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 m        19</code></pre>
<p><img src='images/joins/anti_join_rev.png' class='join'> Order matters in an anti join.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anti_join</span>(exp, subject, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##      id score
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     6    11
## 2     6    12
## 3     7     3</code></pre>
</div>
<div id="bind_rows" class="section level3">
<h3><span class="header-section-number">12.5.9</span> bind_rows()</h3>
<p><a name="bind_rows"></a></p>
<p>You can combine the rows of two tables with <code>bind_rows</code>.</p>
<p>Here we’ll add subject data for subjects 6-9 and bind that to the original subject table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_subjects &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">id =</span> <span class="kw">seq</span>(<span class="dv">6</span>, <span class="dv">9</span>),
  <span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>),
  <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">19</span>)
)

<span class="kw">bind_rows</span>(subject, new_subjects)</code></pre></div>
<pre><code>## # A tibble: 9 x 3
##      id sex     age
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 m        19
## 2     2 m        22
## 3     3 &lt;NA&gt;     NA
## 4     4 f        19
## 5     5 f        18
## 6     6 m        19
## 7     7 m        16
## 8     8 f        20
## 9     9 f        19</code></pre>
<p>The columns just have to have the same names, they don’t have to be in the same order. Any columns that differ between the two tables will just have <code>NA</code> values for entries from the other table.</p>
<p>If a row is duplicated between the two tables (like id 5 below), the row will also be duplicated in the resulting table. If your tables have the exact same columns, you can use <code>union()</code> (see below) to avoid duplicates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_subjects &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">id =</span> <span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">9</span>),
  <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">19</span>),
  <span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>),
  <span class="dt">new =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)
)

<span class="kw">bind_rows</span>(subject, new_subjects)</code></pre></div>
<pre><code>## # A tibble: 10 x 4
##       id sex     age   new
##    &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1 m        19    NA
##  2     2 m        22    NA
##  3     3 &lt;NA&gt;     NA    NA
##  4     4 f        19    NA
##  5     5 f        18    NA
##  6     5 f        18     1
##  7     6 m        19     2
##  8     7 m        16     3
##  9     8 f        20     4
## 10     9 f        19     5</code></pre>
</div>
<div id="bind_cols" class="section level3">
<h3><span class="header-section-number">12.5.10</span> bind_cols()</h3>
<p><a name="bind_cols"></a></p>
<p>You can merge two tables with the same number of rows using <code>bind_cols</code>. This is only useful if the two tables have their rows in the exact same order. The only advantage over a left join is when the tables don’t have any IDs to join by and you have to rely solely on their order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_info &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>)
)

<span class="kw">bind_cols</span>(subject, new_info)</code></pre></div>
<pre><code>## # A tibble: 5 x 4
##      id sex     age colour
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; 
## 1     1 m        19 red   
## 2     2 m        22 orange
## 3     3 &lt;NA&gt;     NA yellow
## 4     4 f        19 green 
## 5     5 f        18 blue</code></pre>
</div>
<div id="intersect" class="section level3">
<h3><span class="header-section-number">12.5.11</span> intersect()</h3>
<p><a name="intersect"></a></p>
<p><code>intersect()</code> returns all rows in two tables that match exactly. The columns don’t have to be in the same order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_subjects &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">id =</span> <span class="kw">seq</span>(<span class="dv">4</span>, <span class="dv">9</span>),
  <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">19</span>),
  <span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>)
)

dplyr<span class="op">::</span><span class="kw">intersect</span>(subject, new_subjects)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##      id sex     age
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     4 f        19
## 2     5 f        18</code></pre>
</div>
<div id="union" class="section level3">
<h3><span class="header-section-number">12.5.12</span> union()</h3>
<p><a name="union"></a></p>
<p><code>union()</code> returns all the rows from both tables, removing duplicate rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">union</span>(subject, new_subjects)</code></pre></div>
<pre><code>## # A tibble: 9 x 3
##      id sex     age
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     9 f        19
## 2     8 f        20
## 3     7 m        16
## 4     6 m        19
## 5     5 f        18
## 6     4 f        19
## 7     3 &lt;NA&gt;     NA
## 8     2 m        22
## 9     1 m        19</code></pre>
</div>
<div id="setdiff" class="section level3">
<h3><span class="header-section-number">12.5.13</span> setdiff()</h3>
<p><a name="setdiff"></a></p>
<p><code>setdiff</code> returns rows that are in the first table, but not in the second table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setdiff</span>(subject, new_subjects)</code></pre></div>
<pre><code>## # A tibble: 3 x 3
##      id   age sex  
##   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
## 1     1    19 m    
## 2     2    22 m    
## 3     3    NA &lt;NA&gt;</code></pre>
<p>Order matters for <code>setdiff</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setdiff</span>(new_subjects, subject)</code></pre></div>
<pre><code>## # A tibble: 4 x 3
##      id sex     age
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     6 m        19
## 2     7 m        16
## 3     8 f        20
## 4     9 f        19</code></pre>
<!--
## Example

### Load and process data

These data and cleaning code are from [Data cleaning](03_tidyr.html)


```r
# load country data from a CSV file on the web
library(readxl)
ccodes <- read_csv("https://raw.githubusercontent.com/lukes/ISO-3166-Countries-with-Regional-Codes/master/all/all.csv")
```

```
## Parsed with column specification:
## cols(
##   name = col_character(),
##   `alpha-2` = col_character(),
##   `alpha-3` = col_character(),
##   `country-code` = col_character(),
##   `iso_3166-2` = col_character(),
##   region = col_character(),
##   `sub-region` = col_character(),
##   `intermediate-region` = col_character(),
##   `region-code` = col_character(),
##   `sub-region-code` = col_character(),
##   `intermediate-region-code` = col_character()
## )
```

```r
infmort <- read_csv("data/infmort.csv") %>%  # load infant mortality data from a CSV file
  separate(                                  # separate the stats column into its 3 parts
    3, 
    c("rate", "ci_low", "ci_hi"), 
    extra = "drop", 
    sep = "(\\[|-|])", 
    convert = TRUE
  )
```

```
## Parsed with column specification:
## cols(
##   Country = col_character(),
##   Year = col_double(),
##   `Infant mortality rate (probability of dying between birth and age 1 per 1000 live births)` = col_character()
## )
```

```r
matmort <- read_xls("data/matmort.xls") %>%   # load maternal mortality data from an excel file
  gather("Year", "stats", `1990`:`2015`) %>%  # convert to long format
  mutate(stats = gsub(" ", "", stats)) %>%    # get rid of spaces in stats column
  separate(                                   # separate the stats column into its 3 parts
    stats, 
    c("rate", "ci_low", "ci_hi"), 
    extra = "drop", 
    convert = TRUE
  )
```

```
## readxl works best with a newer version of the tibble package.
## You currently have tibble v1.4.2.
## Falling back to column name repair from tibble <= v1.4.2.
## Message displays once per session.
```

### inner_join()

`inner_join(x, y, by = NULL, suffix = c(".x", ".y")`


```r
infmatmort <- inner_join(matmort, infmort, by = c("Country", "Year"))
```

<pre><code>Error in inner_join_impl(x, y, by$x, by$y, suffix$x, suffix$y, check_na_matches(na_matches)) : 
  Can't join on 'Year' x 'Year' because of incompatible types (character / integer)</code></pre>

#### Incompatible tpyes

Oops. `Year` is an integer type in `infmort` and a character type in `matmort`. 
We can fix that by adding `convert = TRUE` to the `gather` function.


```r
matmort <- read_xls("data/matmort.xls") %>%   
  gather("Year", "stats", `1990`:`2015`, convert = TRUE) %>%
  mutate(stats = gsub(" ", "", stats)) %>%
  separate(
    stats, 
    c("rate", "ci_low", "ci_hi"), 
    extra = "drop", 
    convert = TRUE
  )

infmatmort <- inner_join(matmort, infmort, by = c("Country", "Year"))

head(infmatmort)
```

```
## # A tibble: 6 x 8
##   Country      Year rate.x ci_low.x ci_hi.x rate.y ci_low.y ci_hi.y
##   <chr>       <dbl>  <int>    <int>   <int>  <dbl>    <dbl>   <dbl>
## 1 Afghanistan  1990   1340      878    1950  122.     112.    136. 
## 2 Albania      1990     71       58      88   35.1     31.3    39.2
## 3 Algeria      1990    216      141     327   39.7     37.1    42.3
## 4 Angola       1990   1160      627    2020  134.     120.    151  
## 5 Argentina    1990     72       64      80   24.4     24      24.9
## 6 Armenia      1990     58       51      65   42.5     39      46.4
```

#### Disambiguate duplicate column names with `suffix`

Maybe we shouldn't have given the rates and CIs the same names in the infant and 
maternal mortality tables if we were going to join them. We could fix that by 
changing the names in the `separate` functions to be unique. Here, we'll add the 
suffixes "_mat" and "_inf" to distinguish them.


```r
infmatmort <- inner_join(
  matmort, 
  infmort, 
  by = c("Country", "Year"),
  suffix = c("_mat", "_inf")
)

head(infmatmort)
```

```
## # A tibble: 6 x 8
##   Country  Year rate_mat ci_low_mat ci_hi_mat rate_inf ci_low_inf ci_hi_inf
##   <chr>   <dbl>    <int>      <int>     <int>    <dbl>      <dbl>     <dbl>
## 1 Afghan…  1990     1340        878      1950    122.       112.      136. 
## 2 Albania  1990       71         58        88     35.1       31.3      39.2
## 3 Algeria  1990      216        141       327     39.7       37.1      42.3
## 4 Angola   1990     1160        627      2020    134.       120.      151  
## 5 Argent…  1990       72         64        80     24.4       24        24.9
## 6 Armenia  1990       58         51        65     42.5       39        46.4
```

### full_join()

`full_join(x, y, by = NULL, suffix = c(".x", ".y")`

A full join lets you join up rows in two tables while keeping all of the 
information from both tables. If a row doesn't have a match in the other table, 
the other table's column values are set to `NA`.


```r
infmatmort <- full_join(
  matmort, 
  infmort, 
  by = c("Country", "Year"),
  suffix = c("_mat", "_inf")
)

infmatmort %>% filter(Country == "Djibouti", Year < 1993)
```

```
## # A tibble: 3 x 8
##   Country  Year rate_mat ci_low_mat ci_hi_mat rate_inf ci_low_inf ci_hi_inf
##   <chr>   <dbl>    <int>      <int>     <int>    <dbl>      <dbl>     <dbl>
## 1 Djibou…  1990      517        291       907     92.7       81.2      106.
## 2 Djibou…  1992       NA         NA        NA     89.6       79        102.
## 3 Djibou…  1991       NA         NA        NA     91         80        104.
```

### left_join()

`left_join(x, y, by = NULL, suffix = c(".x", ".y")`

Use a `left_join()` if you want to keep all the data in the main (x, left) table 
and join data from another (y, right) table if it exists.

<p class="alert alert-warning">Notice that the `by` argument now needs to specify both the left 
and right tables' columns (`by = c("Country" = "name")`) because we're joining 
on columns that have different names.</p>



```r
infmatmort_region <- infmatmort %>%
  left_join(ccodes, by = c("Country" = "name"))

head(infmatmort_region)
```

```
## # A tibble: 6 x 18
##   Country  Year rate_mat ci_low_mat ci_hi_mat rate_inf ci_low_inf ci_hi_inf
##   <chr>   <dbl>    <int>      <int>     <int>    <dbl>      <dbl>     <dbl>
## 1 Afghan…  1990     1340        878      1950    122.       112.      136. 
## 2 Albania  1990       71         58        88     35.1       31.3      39.2
## 3 Algeria  1990      216        141       327     39.7       37.1      42.3
## 4 Angola   1990     1160        627      2020    134.       120.      151  
## 5 Argent…  1990       72         64        80     24.4       24        24.9
## 6 Armenia  1990       58         51        65     42.5       39        46.4
## # ... with 10 more variables: `alpha-2` <chr>, `alpha-3` <chr>,
## #   `country-code` <chr>, `iso_3166-2` <chr>, region <chr>,
## #   `sub-region` <chr>, `intermediate-region` <chr>, `region-code` <chr>,
## #   `sub-region-code` <chr>, `intermediate-region-code` <chr>
```

### right_join()

`right_join(x, y, by = NULL, suffix = c(".x", ".y")`

We really just wanted the region, not all the extra data from the country codes. 
We can just select the columns we want when we load the country codes data. 

If we start with the `ccodes` table, we can `right_join()` the `infmatmort` table, 
which is just the opposite of a left join (keeps all the data from the "right" 
joined table and any data from the "left" table that matches). 

<p class="alert alert-warning">Remember to switch 
the order of the `by` columns if they have different names in the main and 
optional data tables.</p>


```r
infmatmort_region <- ccodes %>%
  select(name, region) %>%
  right_join(infmatmort, by = c("name" = "Country"))

head(infmatmort_region)
```

```
## # A tibble: 6 x 9
##   name  region  Year rate_mat ci_low_mat ci_hi_mat rate_inf ci_low_inf
##   <chr> <chr>  <dbl>    <int>      <int>     <int>    <dbl>      <dbl>
## 1 Afgh… Asia    1990     1340        878      1950    122.       112. 
## 2 Alba… Europe  1990       71         58        88     35.1       31.3
## 3 Alge… Africa  1990      216        141       327     39.7       37.1
## 4 Ango… Africa  1990     1160        627      2020    134.       120. 
## 5 Arge… Ameri…  1990       72         64        80     24.4       24  
## 6 Arme… Asia    1990       58         51        65     42.5       39  
## # ... with 1 more variable: ci_hi_inf <dbl>
```


### Plot maternal vs infant mortality by region

So let's make a graph that we couldn't have easily made with 3 separate data tables


```r
infmatmort_region %>%
  filter(Year == 1990) %>%
  group_by(name, region) %>%
  summarise(
    matmort = mean(rate_mat),
    infmort = mean(rate_inf)
  ) %>%
  ggplot(aes(infmort, matmort, colour = region)) +
  geom_smooth(method = "lm") +
  geom_point() +
  facet_grid(.~region)
```

```
## Warning: Removed 13 rows containing non-finite values (stat_smooth).
```

```
## Warning: Removed 13 rows containing missing values (geom_point).
```

<img src="06-joins_files/figure-html/unnamed-chunk-9-1.png" width="672" />
-->
</div>
</div>
<div id="exercises-3" class="section level2">
<h2><span class="header-section-number">12.6</span> Exercises</h2>
<div id="mutating-joins" class="section level3">
<h3><span class="header-section-number">12.6.1</span> Mutating joins</h3>
<p>Load data from <a href="data/disgust_scores.csv">disgust_scores.csv</a>, <a href="data/personality_scores.csv">personality_scores.csv</a> and <a href="data/users.csv">users.csv</a>. Each participant is identified by a unique <code>user_id</code>.</p>
<ol style="list-style-type: decimal">
<li><p>Add participant data to the disgust table.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">disgust &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/disgust_scores.csv&quot;</span>)
ocean &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/personality_scores.csv&quot;</span>)
user &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/users.csv&quot;</span>)

study1 &lt;-<span class="st"> </span><span class="kw">left_join</span>(disgust, user, <span class="dt">by =</span> <span class="st">&quot;user_id&quot;</span>)

<span class="kw">head</span>(study1)</code></pre></div>
<pre><code>## # A tibble: 6 x 8
##      id user_id date       moral pathogen sexual sex    birthday  
##   &lt;dbl&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;date&gt;    
## 1     1       1 2008-07-10  1.43     2.71  1.71  female 1976-11-18
## 2     3  155324 2008-07-11  3        2.57  1.86  female 1984-09-30
## 3     4  155366 2008-07-12  5.57     4     0.429 male   1982-04-09
## 4     5  155370 2008-07-12  5.71     4.86  4.71  female 1968-04-04
## 5     6  155386 2008-07-12  1.43     3.86  3.71  male   1983-04-22
## 6     7  155409 2008-07-12  4.14     4.14  1.57  male   1983-03-31</code></pre>
</div>
<p><em>Intermediate</em>: Calculate the age of each participant on the date they did the disgust questionnaire. Round to the nearest tenth of a year.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)

study1_ages &lt;-<span class="st"> </span>study1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">age =</span> date <span class="op">-</span><span class="st"> </span>birthday,
    <span class="dt">age_days =</span> <span class="kw">as.integer</span>(age),
    <span class="dt">age_years =</span> <span class="kw">round</span>(age_days<span class="op">/</span><span class="fl">365.25</span>, <span class="dv">1</span>)
  )

study1_ages <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(date, birthday<span class="op">:</span>age_years) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>()</code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   date       birthday   age        age_days age_years
##   &lt;date&gt;     &lt;date&gt;     &lt;time&gt;        &lt;int&gt;     &lt;dbl&gt;
## 1 2008-07-10 1976-11-18 11557 days    11557      31.6
## 2 2008-07-11 1984-09-30  8685 days     8685      23.8
## 3 2008-07-12 1982-04-09  9591 days     9591      26.3
## 4 2008-07-12 1968-04-04 14709 days    14709      40.3
## 5 2008-07-12 1983-04-22  9213 days     9213      25.2
## 6 2008-07-12 1983-03-31  9235 days     9235      25.3</code></pre>
</div></li>
<li><p>Add the participant data to the disgust data, but have the columns from the participant table first.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study2 &lt;-<span class="st"> </span><span class="kw">right_join</span>(user, disgust, <span class="dt">by =</span> <span class="st">&quot;user_id&quot;</span>)
<span class="kw">head</span>(study2)</code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   user_id sex    birthday      id date       moral pathogen sexual
##     &lt;dbl&gt; &lt;chr&gt;  &lt;date&gt;     &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1       1 female 1976-11-18     1 2008-07-10  1.43     2.71  1.71 
## 2  155324 female 1984-09-30     3 2008-07-11  3        2.57  1.86 
## 3  155366 male   1982-04-09     4 2008-07-12  5.57     4     0.429
## 4  155370 female 1968-04-04     5 2008-07-12  5.71     4.86  4.71 
## 5  155386 male   1983-04-22     6 2008-07-12  1.43     3.86  3.71 
## 6  155409 male   1983-03-31     7 2008-07-12  4.14     4.14  1.57</code></pre>
</div>
<p><em>Intermediate</em>: How many times was the disgust questionnaire completed by each sex?</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   sex          n
##   &lt;chr&gt;    &lt;int&gt;
## 1 female   13886
## 2 intersex     3
## 3 male      6012
## 4 &lt;NA&gt;        99</code></pre>
</div>
<p><em>Advanced</em>: Make a graph of how many people completed the questionnaire each year.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">substr</span>(date, <span class="dv">1</span>, <span class="dv">4</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">times_completed =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(year, times_completed, <span class="dt">fill =</span> year)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Times Completed&quot;</span>
  ) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="06-joins_files/figure-html/ex-2-a-1.png" width="672" /></p>
</div></li>
<li><p>Create a table with only disgust and personality data from the same <code>user_id</code> collected on the same <code>date</code>.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study3 &lt;-<span class="st"> </span><span class="kw">inner_join</span>(disgust, ocean, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;user_id&quot;</span>, <span class="st">&quot;date&quot;</span>))
<span class="kw">head</span>(study3)</code></pre></div>
<pre><code>## # A tibble: 6 x 11
##      id user_id date       moral pathogen sexual    Ag    Co    Ex    Ne
##   &lt;dbl&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     3  155324 2008-07-11  3        2.57  1.86   4      3.3  4.89  2.38
## 2     6  155386 2008-07-12  1.43     3.86  3.71   3.14   2.6  4     0.25
## 3    17  155567 2008-07-14  5.57     4.71  2.57   5.29   5.7  3.89  1.12
## 4    18  155571 2008-07-14  2.71     6     4.43   3.71   3.8  4.56  2.25
## 5    21  155665 2008-07-15  4.14     4.14  3.43   2.86   1.8  4.67  3.12
## 6    22  155682 2008-07-15  2.71     3     0.714  3.43   3    3.56  1.38
## # ... with 1 more variable: Op &lt;dbl&gt;</code></pre>
</div>
<p><em>Intermediate</em>: Join data from the same <code>user_id</code>, regardless of <code>date</code>. Does this give you the same data table as above?</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study3_nodate &lt;-<span class="st"> </span><span class="kw">inner_join</span>(disgust, ocean, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;user_id&quot;</span>))
<span class="kw">head</span>(study3_nodate)</code></pre></div>
<pre><code>## # A tibble: 6 x 12
##      id user_id date.x     moral pathogen sexual date.y        Ag    Co
##   &lt;dbl&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1     1       1 2008-07-10  1.43     2.71   1.71 2006-02-08  2.57   3  
## 2     3  155324 2008-07-11  3        2.57   1.86 2008-07-11  4      3.3
## 3     6  155386 2008-07-12  1.43     3.86   3.71 2008-07-12  3.14   2.6
## 4    17  155567 2008-07-14  5.57     4.71   2.57 2008-07-14  5.29   5.7
## 5    18  155571 2008-07-14  2.71     6      4.43 2008-07-14  3.71   3.8
## 6    20  124756 2008-07-14  5.43     5.14   2.71 2008-01-23  4.86   3.8
## # ... with 3 more variables: Ex &lt;dbl&gt;, Ne &lt;dbl&gt;, Op &lt;dbl&gt;</code></pre>
</div></li>
<li><p>Create a table of the disgust and personality data with each <code>user_id:date</code> on a single row, containing <em>all</em> of the data from both tables.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study4 &lt;-<span class="st"> </span><span class="kw">full_join</span>(disgust, ocean, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;user_id&quot;</span>, <span class="st">&quot;date&quot;</span>))
<span class="kw">head</span>(study4)</code></pre></div>
<pre><code>## # A tibble: 6 x 11
##      id user_id date       moral pathogen sexual    Ag    Co    Ex    Ne
##   &lt;dbl&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1       1 2008-07-10  1.43     2.71  1.71  NA     NA   NA    NA   
## 2     3  155324 2008-07-11  3        2.57  1.86   4      3.3  4.89  2.38
## 3     4  155366 2008-07-12  5.57     4     0.429 NA     NA   NA    NA   
## 4     5  155370 2008-07-12  5.71     4.86  4.71  NA     NA   NA    NA   
## 5     6  155386 2008-07-12  1.43     3.86  3.71   3.14   2.6  4     0.25
## 6     7  155409 2008-07-12  4.14     4.14  1.57  NA     NA   NA    NA   
## # ... with 1 more variable: Op &lt;dbl&gt;</code></pre>
</div></li>
</ol>
</div>
<div id="filtering-joins" class="section level3">
<h3><span class="header-section-number">12.6.2</span> Filtering joins</h3>
<ol start="5" style="list-style-type: decimal">
<li><p>Create a table of just the data from the disgust table for users who completed the personality questionnaire that same day.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study5 &lt;-<span class="st"> </span><span class="kw">semi_join</span>(disgust, ocean, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;user_id&quot;</span>, <span class="st">&quot;date&quot;</span>))
<span class="kw">head</span>(study5)</code></pre></div>
<pre><code>## # A tibble: 6 x 6
##      id user_id date       moral pathogen sexual
##   &lt;dbl&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1     3  155324 2008-07-11  3        2.57  1.86 
## 2     6  155386 2008-07-12  1.43     3.86  3.71 
## 3    17  155567 2008-07-14  5.57     4.71  2.57 
## 4    18  155571 2008-07-14  2.71     6     4.43 
## 5    21  155665 2008-07-15  4.14     4.14  3.43 
## 6    22  155682 2008-07-15  2.71     3     0.714</code></pre>
</div></li>
<li><p>Create a table of data from users who did not complete either the personality questionnaire or the disgust questionnaire. (<em>Hint: this will require two steps; use pipes.</em>)</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study6 &lt;-<span class="st"> </span>user <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">anti_join</span>(ocean, <span class="dt">by =</span> <span class="st">&quot;user_id&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">anti_join</span>(disgust, <span class="dt">by =</span> <span class="st">&quot;user_id&quot;</span>)
<span class="kw">head</span>(study6)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   user_id sex    birthday  
##     &lt;dbl&gt; &lt;chr&gt;  &lt;date&gt;    
## 1       9 male   1972-01-19
## 2      10 female 1978-06-20
## 3      17 female 1981-11-21
## 4      19 female 1980-08-08
## 5      20 male   1964-08-27
## 6      21 male   1945-06-13</code></pre>
</div></li>
</ol>
</div>
<div id="binding-and-sets" class="section level3">
<h3><span class="header-section-number">12.6.3</span> Binding and sets</h3>
<ol start="7" style="list-style-type: decimal">
<li><p>Load new user data from <a href="data/users2.csv">users2.csv</a>. Bind them into a single table.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">user2 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/users2.csv&quot;</span>)
users_all &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(user, user2)
<span class="kw">head</span>(users_all)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   user_id sex    birthday  
##     &lt;dbl&gt; &lt;chr&gt;  &lt;date&gt;    
## 1       0 &lt;NA&gt;   NA        
## 2       1 female 1976-11-18
## 3       2 male   1985-10-09
## 4       5 male   1980-06-26
## 5       8 male   1968-06-21
## 6       9 male   1972-01-19</code></pre>
</div></li>
<li><p>How many users are in both the first and second user table?</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">intersect</span>(user, user2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>()</code></pre></div>
<pre><code>## [1] 11602</code></pre>
</div></li>
<li><p>How many unique users are there in total across the first and second user tables?</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">union</span>(user, user2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>()</code></pre></div>
<pre><code>## [1] 100441</code></pre>
</div></li>
<li><p>How many users are in the first, but not the second, user table?</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">setdiff</span>(user, user2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>()</code></pre></div>
<pre><code>## [1] 40441</code></pre>
</div></li>
<li><p>How many users are in the second, but not the first, user table?</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">setdiff</span>(user2, user) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>()</code></pre></div>
<pre><code>## [1] 48398</code></pre>
</div></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="class-notes-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="func.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
